<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLipMouse/FABI ESP32 firmware: /home/beni/sync/Projects/FH/FLipMouse-esp32/main/config_switcher.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLipMouse/FABI ESP32 firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">config_switcher.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>CONTINOUS TASK + FUNCTIONAL TASK - This module takes care of configuration loading.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config__switcher_8h_source.html">config_switcher.h</a>&quot;</code><br />
</div>
<p><a href="config__switcher_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7ce0df38eb467e59f209470c8f5ac4e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a7ce0df38eb467e59f209470c8f5ac4e6">LOG_TAG</a>&#160;&#160;&#160;&quot;cfgsw&quot;</td></tr>
<tr class="separator:a7ce0df38eb467e59f209470c8f5ac4e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a49dfb0d8cde2c693f0340e885fb50c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a4a49dfb0d8cde2c693f0340e885fb50c">CONFIGSWITCHERTASK_PERMANENT_STACKSIZE</a>&#160;&#160;&#160;4096</td></tr>
<tr class="separator:a4a49dfb0d8cde2c693f0340e885fb50c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a921538bec34d128a44a748fd5a2c391f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a1d17932316265a53a6982a2526a4cada">generalConfig_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a921538bec34d128a44a748fd5a2c391f">configGetCurrent</a> (void)</td></tr>
<tr class="memdesc:a921538bec34d128a44a748fd5a2c391f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current config struct.  <a href="#a921538bec34d128a44a748fd5a2c391f">More...</a><br /></td></tr>
<tr class="separator:a921538bec34d128a44a748fd5a2c391f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e6ddb2557b0bf3e2d84952feb0b5a5"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a68e6ddb2557b0bf3e2d84952feb0b5a5">task_configswitcher_getAT</a> (char *output, void *cfg)</td></tr>
<tr class="memdesc:a68e6ddb2557b0bf3e2d84952feb0b5a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reverse Parsing - get AT command for configswitcher VB.  <a href="#a68e6ddb2557b0bf3e2d84952feb0b5a5">More...</a><br /></td></tr>
<tr class="separator:a68e6ddb2557b0bf3e2d84952feb0b5a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c2e410d8032c65c0700c6ca07429074"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a4c2e410d8032c65c0700c6ca07429074">configUpdate</a> (void)</td></tr>
<tr class="memdesc:a4c2e410d8032c65c0700c6ca07429074"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trigger a config update.  <a href="#a4c2e410d8032c65c0700c6ca07429074">More...</a><br /></td></tr>
<tr class="separator:a4c2e410d8032c65c0700c6ca07429074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20db6aabb98f5c9c7cea48e950bada5b"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a20db6aabb98f5c9c7cea48e950bada5b">configUpdateVB</a> (void *param, <a class="el" href="common_8h.html#ac27b6f4710923c6689834e86aea228ac">command_type_t</a> type, uint8_t vb)</td></tr>
<tr class="memdesc:a20db6aabb98f5c9c7cea48e950bada5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update one virtual button.  <a href="#a20db6aabb98f5c9c7cea48e950bada5b">More...</a><br /></td></tr>
<tr class="separator:a20db6aabb98f5c9c7cea48e950bada5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5af5079d1982d42e165039e6de7e40a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#af5af5079d1982d42e165039e6de7e40a">configSwitcherTask</a> (void *params)</td></tr>
<tr class="memdesc:af5af5079d1982d42e165039e6de7e40a"><td class="mdescLeft">&#160;</td><td class="mdescRight">CONTINOUS TASK - Config switcher task, internal config reloading.  <a href="#af5af5079d1982d42e165039e6de7e40a">More...</a><br /></td></tr>
<tr class="separator:af5af5079d1982d42e165039e6de7e40a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a083adf41746c3380dcc6dbc099047f2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a083adf41746c3380dcc6dbc099047f2e">task_configswitcher</a> (<a class="el" href="config__switcher_8h.html#aa6d38946df351bfaec1994fdb081e7db">taskConfigSwitcherConfig_t</a> *param)</td></tr>
<tr class="memdesc:a083adf41746c3380dcc6dbc099047f2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">FUNCTIONAL TASK - Load another slot.  <a href="#a083adf41746c3380dcc6dbc099047f2e">More...</a><br /></td></tr>
<tr class="separator:a083adf41746c3380dcc6dbc099047f2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafed047c8d04b814a85239e031cbad7b"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#aafed047c8d04b814a85239e031cbad7b">configSwitcherInit</a> (void)</td></tr>
<tr class="memdesc:aafed047c8d04b814a85239e031cbad7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializing the config switching functionality.  <a href="#aafed047c8d04b814a85239e031cbad7b">More...</a><br /></td></tr>
<tr class="separator:aafed047c8d04b814a85239e031cbad7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a67130d7a5483b1a7cee6badb08e0dbc6"><td class="memItemLeft" align="right" valign="top">TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a67130d7a5483b1a7cee6badb08e0dbc6">currentTasks</a> [<a class="el" href="common_8h.html#aee89b7237c851b73f694c2fb1530cbeb">NUMBER_VIRTUALBUTTONS</a> *4]</td></tr>
<tr class="memdesc:a67130d7a5483b1a7cee6badb08e0dbc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array containing all currently running FUNCTIONAL task handles.  <a href="#a67130d7a5483b1a7cee6badb08e0dbc6">More...</a><br /></td></tr>
<tr class="separator:a67130d7a5483b1a7cee6badb08e0dbc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04ff31fa74901c29c54c862980d47823"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a04ff31fa74901c29c54c862980d47823">currentTaskParameters</a> [<a class="el" href="common_8h.html#aee89b7237c851b73f694c2fb1530cbeb">NUMBER_VIRTUALBUTTONS</a> *4]</td></tr>
<tr class="memdesc:a04ff31fa74901c29c54c862980d47823"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of pointers to FUNCTIONAL task parameters.  <a href="#a04ff31fa74901c29c54c862980d47823">More...</a><br /></td></tr>
<tr class="separator:a04ff31fa74901c29c54c862980d47823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb033b9bef9bb354a3b2c4734b4ec9d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#aceb033b9bef9bb354a3b2c4734b4ec9d">currentTaskParametersUpdate</a> [<a class="el" href="common_8h.html#aee89b7237c851b73f694c2fb1530cbeb">NUMBER_VIRTUALBUTTONS</a> *4]</td></tr>
<tr class="memdesc:aceb033b9bef9bb354a3b2c4734b4ec9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of pointers to FUNCTIONAL task parameters (for updating current config)  <a href="#aceb033b9bef9bb354a3b2c4734b4ec9d">More...</a><br /></td></tr>
<tr class="separator:aceb033b9bef9bb354a3b2c4734b4ec9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd2fb9b048f1de98ee98dd54077541c2"><td class="memItemLeft" align="right" valign="top">TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#abd2fb9b048f1de98ee98dd54077541c2">configswitcher_handle</a></td></tr>
<tr class="separator:abd2fb9b048f1de98ee98dd54077541c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c577cdbcaa9439f9458a9e5d39c143"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a1d17932316265a53a6982a2526a4cada">generalConfig_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8c.html#a73c577cdbcaa9439f9458a9e5d39c143">currentConfigLoaded</a></td></tr>
<tr class="separator:a73c577cdbcaa9439f9458a9e5d39c143"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>CONTINOUS TASK + FUNCTIONAL TASK - This module takes care of configuration loading. </p>
<p>The config_switcher module is used to control all tasks assigned to virtual buttons (called FUNCTIONAL TASKS). If a new configuration should be loaded from the storage, all previously loaded tasks are deleted and new tasks are loaded.</p>
<p>A slot configuration is provided by the config_storage, which is controlled by this module.</p>
<p>task_configswitcher is the FUNCTIONAL TASK for triggering a slot switch. configSwitcherTask is the CONTINOUS TASK which monitors the queue for any config switching action.</p>
<dl class="section note"><dt>Note</dt><dd>If you want to add a new FUNCTIONAL TASK, please include headers here &amp; add loading functionality to configSwitcherTask. </dd></dl>

<p class="definition">Definition in file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4a49dfb0d8cde2c693f0340e885fb50c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a49dfb0d8cde2c693f0340e885fb50c">&#9670;&nbsp;</a></span>CONFIGSWITCHERTASK_PERMANENT_STACKSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONFIGSWITCHERTASK_PERMANENT_STACKSIZE&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Stacksize for continous task configSwitcherTask. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="config__switcher_8c.html#af5af5079d1982d42e165039e6de7e40a" title="CONTINOUS TASK - Config switcher task, internal config reloading. ">configSwitcherTask</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00047">47</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00510">configSwitcherInit()</a>.</p>

</div>
</div>
<a id="a7ce0df38eb467e59f209470c8f5ac4e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce0df38eb467e59f209470c8f5ac4e6">&#9670;&nbsp;</a></span>LOG_TAG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOG_TAG&#160;&#160;&#160;&quot;cfgsw&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tag for ESP_LOG logging </p>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00043">43</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00510">configSwitcherInit()</a>, <a class="el" href="config__switcher_8c_source.html#l00198">configSwitcherTask()</a>, <a class="el" href="config__switcher_8c_source.html#l00131">configUpdate()</a>, <a class="el" href="config__switcher_8c_source.html#l00163">configUpdateVB()</a>, and <a class="el" href="config__switcher_8c_source.html#l00444">task_configswitcher()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a921538bec34d128a44a748fd5a2c391f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a921538bec34d128a44a748fd5a2c391f">&#9670;&nbsp;</a></span>configGetCurrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a1d17932316265a53a6982a2526a4cada">generalConfig_t</a>* configGetCurrent </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current config struct. </p>
<p>This method is used to get a reference to the current config struct. The caller can use this reference to change the configuration and update the config afterwards (via the config_switcher queue).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="common_8h.html#a4701c432a28c389e4b8557f2fa3323d1" title="Queue to receive config changing commands. ">config_switcher</a> </dd>
<dd>
<a class="el" href="config__switcher_8c.html#a73c577cdbcaa9439f9458a9e5d39c143">currentConfigLoaded</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the current config struct </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00098">98</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__debouncer_8c_source.html#l00180">debouncerCallback()</a>, <a class="el" href="task__commands_8c_source.html#l00745">doGeneralCmdParsing()</a>, <a class="el" href="task__commands_8c_source.html#l00585">doInfraredParsing()</a>, <a class="el" href="task__commands_8c_source.html#l01031">doKeyboardParsing()</a>, <a class="el" href="task__commands_8c_source.html#l00156">doMouthpieceSettingsParsing()</a>, <a class="el" href="task__commands_8c_source.html#l00394">doStorageParsing()</a>, <a class="el" href="hal__adc_8c_source.html#l00242">halAdcProcessPressure()</a>, <a class="el" href="hal__ble_8c_source.html#l00426">halBLEInit()</a>, <a class="el" href="hal__ble_8c_source.html#l00181">halBleTaskKeyboardPress()</a>, <a class="el" href="hal__ble_8c_source.html#l00253">halBleTaskKeyboardRelease()</a>, <a class="el" href="hal__io_8c_source.html#l00286">halIOBuzzerTask()</a>, <a class="el" href="hal__io_8c_source.html#l00418">halIOInit()</a>, <a class="el" href="hal__io_8c_source.html#l00344">halIOLEDTask()</a>, <a class="el" href="task__infrared_8c_source.html#l00270">infrared_set_edge_timeout()</a>, <a class="el" href="task__mouse_8c_source.html#l00062">mouse_get_wheel()</a>, <a class="el" href="task__mouse_8c_source.html#l00044">mouse_set_wheel()</a>, <a class="el" href="task__commands_8c_source.html#l01555">printAllSlots()</a>, and <a class="el" href="task__debouncer_8c_source.html#l00305">task_debouncer()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_a921538bec34d128a44a748fd5a2c391f_icgraph.png" border="0" usemap="#config__switcher_8c_a921538bec34d128a44a748fd5a2c391f_icgraph" alt=""/></div>
<map name="config__switcher_8c_a921538bec34d128a44a748fd5a2c391f_icgraph" id="config__switcher_8c_a921538bec34d128a44a748fd5a2c391f_icgraph">
<area shape="rect" id="node2" href="task__debouncer_8c.html#a4a76abdbb849aa0bbc66aa001c6f4af9" title="Timer callback for debouncing. " alt="" coords="203,805,337,832"/>
<area shape="rect" id="node4" href="task__debouncer_8h.html#a79d88e490be7198b9cc37556c66b837b" title="Debouncing main task. " alt="" coords="649,754,764,781"/>
<area shape="rect" id="node6" href="task__commands_8c.html#a7f6500be563a3dce7f0854fceed02fab" title="doGeneralCmdParsing" alt="" coords="630,602,783,629"/>
<area shape="rect" id="node10" href="task__commands_8c.html#a937cdeb2f02b0c5d9a0f94a0f69e9328" title="doInfraredParsing" alt="" coords="425,450,549,477"/>
<area shape="rect" id="node11" href="task__commands_8c.html#ac3c72c089d32dea93c45f4f9f8d1f244" title="doKeyboardParsing" alt="" coords="639,653,774,680"/>
<area shape="rect" id="node12" href="task__commands_8c.html#a2ad28759e53bb5082853d8d004767115" title="doMouthpieceSettingsParsing" alt="" coords="609,501,804,528"/>
<area shape="rect" id="node13" href="task__commands_8c.html#a69b0c55558b32caa21407de8e2277be9" title="doStorageParsing" alt="" coords="425,298,550,325"/>
<area shape="rect" id="node14" href="hal__adc_8c.html#acd8f9f6194ebeaa854a791879382b515" title="Process pressure sensor (sip &amp; puff) " alt="" coords="189,254,351,281"/>
<area shape="rect" id="node20" href="hal__ble_8h.html#a8ad6c50e81bae3e24e2f86a2797384c2" title="halBLEInit" alt="" coords="879,97,962,124"/>
<area shape="rect" id="node21" href="hal__ble_8c.html#af6a15e1396cb358cd7f1eb6a2a7045a9" title="halBleTaskKeyboardPress" alt="" coords="182,856,358,882"/>
<area shape="rect" id="node22" href="hal__ble_8c.html#adbfa982381d6d09432d7ba1961846b32" title="halBleTaskKeyboardRelease" alt="" coords="175,906,365,933"/>
<area shape="rect" id="node23" href="hal__io_8c.html#a5c30b3b4a88e8f23489485659d53c7c0" title="HAL TASK &#45; Buzzer update task. " alt="" coords="209,102,331,129"/>
<area shape="rect" id="node24" href="hal__io_8h.html#aa5ee74913a09cba6dca62bfdc9f8342b" title="Initializing IO HAL. " alt="" coords="452,160,523,186"/>
<area shape="rect" id="node25" href="hal__io_8c.html#ad83b58c9ee836526a874392c0757f42d" title="HAL TASK &#45; LED update task. " alt="" coords="216,153,324,180"/>
<area shape="rect" id="node26" href="task__infrared_8h.html#a085c1313247cfb56fc663527aa3bdb49" title="Set the time between two IR edges which will trigger the timeout (end of received command) ..." alt="" coords="183,957,357,984"/>
<area shape="rect" id="node27" href="task__mouse_8h.html#ab5cfaaac2cd4ec6fc79546f847db96de" title="Get the current mouse wheel step size. " alt="" coords="424,349,551,376"/>
<area shape="rect" id="node29" href="task__mouse_8h.html#ac5aaa616044b7bef9f75347719181dbe" title="Set current mouse wheel step size. " alt="" coords="424,400,551,426"/>
<area shape="rect" id="node30" href="task__commands_8c.html#ad59215648a26578c22baa7ceae099e0e" title="Print the current slot configurations (general settings + VBs) " alt="" coords="224,558,316,585"/>
<area shape="rect" id="node3" href="task__debouncer_8c.html#a2d41ed2a246a1b8d4ee5510262001e50" title="Start a debouncing timer with given debounce time and VB number. " alt="" coords="447,805,528,832"/>
<area shape="rect" id="node5" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="1243,268,1321,294"/>
<area shape="rect" id="node7" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="861,476,980,502"/>
<area shape="rect" id="node8" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="Init the command parser. " alt="" coords="1050,476,1182,502"/>
<area shape="rect" id="node9" href="task__commands_8h.html#a26091155b4d85093239033d689f363d0" title="Restart the command parser task. " alt="" coords="1037,425,1195,452"/>
<area shape="rect" id="node15" href="hal__adc_8c.html#aee719704e643d27c1faab768cf4bc22e" title="HAL TASK &#45; Threshold task for ADC. " alt="" coords="413,248,561,274"/>
<area shape="rect" id="node16" href="hal__adc_8h.html#a4135bb73c2271b4a27db8d8d81884de7" title="Reload ADC config. " alt="" coords="635,248,778,274"/>
<area shape="rect" id="node17" href="config__switcher_8c.html#af5af5079d1982d42e165039e6de7e40a" title="CONTINOUS TASK &#45; Config switcher task, internal config reloading. " alt="" coords="852,293,989,320"/>
<area shape="rect" id="node19" href="hal__adc_8h.html#a6f0d302f35e5b7f7a1144f0ddace35d2" title="Init the ADC driver module. " alt="" coords="881,242,961,269"/>
<area shape="rect" id="node18" href="config__switcher_8h.html#aafed047c8d04b814a85239e031cbad7b" title="Initializing the config switching functionality. " alt="" coords="1053,293,1179,320"/>
<area shape="rect" id="node28" href="task__commands_8c.html#a580d9f6a840975525358033a35f761d0" title="doMouseParsing" alt="" coords="647,400,766,426"/>
<area shape="rect" id="node31" href="task__commands_8c.html#acea81ba8a182ae78feb2db6418fc1806" title="sendErrorBack" alt="" coords="433,552,541,578"/>
<area shape="rect" id="node32" href="task__commands_8c.html#afc7ebe31a124c2102f8b41577b6dc5b0" title="doJoystickParsing" alt="" coords="642,552,771,578"/>
</map>
</div>

</div>
</div>
<a id="aafed047c8d04b814a85239e031cbad7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafed047c8d04b814a85239e031cbad7b">&#9670;&nbsp;</a></span>configSwitcherInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t configSwitcherInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializing the config switching functionality. </p>
<p>The CONTINOUS task will be loaded to enable slot switches via the task_configswitcher FUNCTIONAL task. </p><dl class="section return"><dt>Returns</dt><dd>ESP_OK if everything is fined, ESP_FAIL otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00510">510</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flipmouse__fabi__esp32__kbdmouse__main_8c_source.html#l00074">app_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_aafed047c8d04b814a85239e031cbad7b_cgraph.png" border="0" usemap="#config__switcher_8c_aafed047c8d04b814a85239e031cbad7b_cgraph" alt=""/></div>
<map name="config__switcher_8c_aafed047c8d04b814a85239e031cbad7b_cgraph" id="config__switcher_8c_aafed047c8d04b814a85239e031cbad7b_cgraph">
<area shape="rect" id="node2" href="config__switcher_8c.html#af5af5079d1982d42e165039e6de7e40a" title="CONTINOUS TASK &#45; Config switcher task, internal config reloading. " alt="" coords="180,467,317,493"/>
<area shape="rect" id="node3" href="hal__storage_8c.html#afad9dd42e1e9762cce888154d22c64ac" title="Start a storage transaction. " alt="" coords="369,87,549,113"/>
<area shape="rect" id="node5" href="hal__storage_8c.html#aad5b764e7c611ff24dbcdd872dc9ae76" title="Load a slot by an action. " alt="" coords="403,289,515,316"/>
<area shape="rect" id="node12" href="hal__storage_8c.html#a5fe9e276fd05e50e4ab9d554ef6f58ca" title="Delete one or all slots. " alt="" coords="847,340,993,367"/>
<area shape="rect" id="node13" href="hal__storage_8c.html#a00b5db14e24d7ada8a42aa6b3f1a1cb7" title="Finish a storage transaction. " alt="" coords="365,239,552,265"/>
<area shape="rect" id="node14" href="hal__storage_8c.html#a75596c64adaa2b8d9104530acc94b094" title="Load a slot by a slot name. " alt="" coords="385,188,532,215"/>
<area shape="rect" id="node16" href="hal__adc_8c.html#a4135bb73c2271b4a27db8d8d81884de7" title="Reload ADC config. " alt="" coords="387,391,530,417"/>
<area shape="rect" id="node24" href="hal__ble_8c.html#accf307974a0046bce38582d0260bf841" title="halBLEReset" alt="" coords="409,441,508,468"/>
<area shape="rect" id="node29" href="hal__serial_8c.html#ab2261f95747ee5806ebdec880d09ca89" title="Reset the serial HID report data. " alt="" coords="1117,695,1223,721"/>
<area shape="rect" id="node30" href="task__mouse_8c.html#aa8f5c0436e569589e735c419fc3d0ed8" title="FUNCTIONAL TASK &#45; Trigger mouse action. " alt="" coords="412,492,505,519"/>
<area shape="rect" id="node31" href="task__macros_8c.html#a7acda2dcac23ebfffade8a15b40d219f" title="FUNCTIONAL TASK &#45; Macro execution. " alt="" coords="413,543,504,569"/>
<area shape="rect" id="node32" href="task__kbd_8c.html#a8ff4618047a049178bfb1d60abfefb5d" title="FUNCTIONAL TASK &#45; trigger keyboard actions. " alt="" coords="405,593,512,620"/>
<area shape="rect" id="node34" href="task__joystick_8c.html#a3040132b9cef8e73060fcd9c17dc116b" title="FUNCTIONAL TASK &#45; Trigger joystick action. " alt="" coords="409,644,508,671"/>
<area shape="rect" id="node35" href="config__switcher_8c.html#a083adf41746c3380dcc6dbc099047f2e" title="FUNCTIONAL TASK &#45; Load another slot. " alt="" coords="389,695,528,721"/>
<area shape="rect" id="node36" href="hal__adc_8c.html#a3217185bc86562dee8617ded3872022f" title="FUNCTIONAL TASK &#45; Trigger zero&#45;point calibration of mouthpiece. " alt="" coords="402,745,515,772"/>
<area shape="rect" id="node38" href="hal__storage_8c.html#abc699ff3996d12d3e6bcc9e372b277e0" title="Load one virtual button config for currently loaded slot. " alt="" coords="822,5,1018,32"/>
<area shape="rect" id="node39" href="hal__storage_8c.html#aa5da838bef47becbd2b5bd96a60c75b3" title="Get number of currently loaded slot. " alt="" coords="373,847,544,889"/>
<area shape="rect" id="node4" href="hal__storage_8c.html#a606e5842dd354f1fb4a738ba95c6d5d1" title="internal function to init the filesystem if handle is invalid " alt="" coords="633,87,736,113"/>
<area shape="rect" id="node6" href="hal__storage_8c.html#a7e0a934f829b47e2445189dd95e962d6" title="Get the number of stored slots. " alt="" coords="823,289,1017,316"/>
<area shape="rect" id="node8" href="hal__storage_8c.html#a3b1b266074bd493fe43dcf980852a422" title="Load a slot by a slot number (starting with 1, 0 is default slot) " alt="" coords="605,239,764,265"/>
<area shape="rect" id="node7" href="hal__storage_8c.html#a4b6566ef5b69c85d422df52435c95d36" title="Internal helper to check for a valid WL handle and the correct tid. " alt="" coords="1334,163,1463,189"/>
<area shape="rect" id="node9" href="hal__storage_8c.html#aed4beb2e1bd8cd78a201fbcb49958cba" title="Create a new default slot. " alt="" coords="837,163,1003,189"/>
<area shape="rect" id="node10" href="hal__storage_8c.html#aadf9ff06990d0f0af2eea2e6f2b8082a" title="Store a generalConfig_t struct. " alt="" coords="1113,137,1227,164"/>
<area shape="rect" id="node11" href="hal__storage_8c.html#a046daab088cb37e318c07c2728ade9d3" title="Store a virtual button config struct. " alt="" coords="1071,188,1269,215"/>
<area shape="rect" id="node15" href="hal__storage_8c.html#aae19bcf97360ccd7af4ddf906ff85141" title="Get the number of a slotname. " alt="" coords="817,75,1023,101"/>
<area shape="rect" id="node17" href="hal__adc_8c.html#aee719704e643d27c1faab768cf4bc22e" title="HAL TASK &#45; Threshold task for ADC. " alt="" coords="611,393,759,420"/>
<area shape="rect" id="node18" href="hal__adc_8c.html#a5e0d74baf098e774b0e3aa0dab621987" title="Read out analog voltages, apply sensor gain and deadzone. " alt="" coords="1109,391,1231,417"/>
<area shape="rect" id="node19" href="hal__adc_8c.html#a8743abcde6f190545c429f072c16106d" title="Report raw values via serial interface. " alt="" coords="1106,492,1234,519"/>
<area shape="rect" id="node22" href="hal__adc_8c.html#acd8f9f6194ebeaa854a791879382b515" title="Process pressure sensor (sip &amp; puff) " alt="" coords="839,441,1001,468"/>
<area shape="rect" id="node20" href="hal__serial_8c.html#a8f987ba001c2a39c959a551a94b5df43" title="Send serial bytes to USB&#45;Serial (USB&#45;CDC) " alt="" coords="1317,543,1480,569"/>
<area shape="rect" id="node21" href="hal__serial_8c.html#a132de0978f07044a393cc1f3b5276ced" title="halSerialSwitchTXChannel" alt="" coords="1528,543,1705,569"/>
<area shape="rect" id="node23" href="config__switcher_8c.html#a921538bec34d128a44a748fd5a2c391f" title="Get the current config struct. " alt="" coords="1109,441,1231,468"/>
<area shape="rect" id="node25" href="esp__hidd__prf__api_8c.html#a0e953976c5ad30d8508ac11bc61cb6b2" title="esp_hidd_send_mouse\l_value" alt="" coords="607,525,762,566"/>
<area shape="rect" id="node28" href="esp__hidd__prf__api_8c.html#a694ff6418e79f3372b3feba7483e3222" title="esp_hidd_send_keyboard\l_value" alt="" coords="600,450,769,491"/>
<area shape="rect" id="node26" href="hid__dev_8c.html#a8ae7c69dfd4b740534df123a303a8832" title="hid_dev_send_report" alt="" coords="849,543,991,569"/>
<area shape="rect" id="node27" href="hid__dev_8c.html#a1a247bc038a3368cea0bde2303aa8301" title="hid_dev_rpt_by_id" alt="" coords="1107,543,1233,569"/>
<area shape="rect" id="node33" href="task__kbd_8c.html#a7d605cb2407a7a7309911c70e28a9884" title="Helper function sending to queues depending on connection type. " alt="" coords="648,593,721,620"/>
<area shape="rect" id="node37" href="hal__adc_8c.html#ae549c157d94729e8b06cb391f0f2c97b" title="Calibration function. " alt="" coords="627,745,742,772"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_aafed047c8d04b814a85239e031cbad7b_icgraph.png" border="0" usemap="#config__switcher_8c_aafed047c8d04b814a85239e031cbad7b_icgraph" alt=""/></div>
<map name="config__switcher_8c_aafed047c8d04b814a85239e031cbad7b_icgraph" id="config__switcher_8c_aafed047c8d04b814a85239e031cbad7b_icgraph">
<area shape="rect" id="node2" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="180,5,259,32"/>
</map>
</div>

</div>
</div>
<a id="af5af5079d1982d42e165039e6de7e40a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5af5079d1982d42e165039e6de7e40a">&#9670;&nbsp;</a></span>configSwitcherTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void configSwitcherTask </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CONTINOUS TASK - Config switcher task, internal config reloading. </p>
<p>This task is used to change the full configuration of this device After sending a request to the config_switcher queue, this task is used to unload all virtual buttons tasks and initializing the virtualbutton tasks with the new functionality. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="common_8h.html#a4701c432a28c389e4b8557f2fa3323d1" title="Queue to receive config changing commands. ">config_switcher</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>Not used, pass NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>On a factory reset, it is necessary to load the default slot again!</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Add __RESTOREFACTORY... </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00198">198</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00510">configSwitcherInit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_af5af5079d1982d42e165039e6de7e40a_cgraph.png" border="0" usemap="#config__switcher_8c_af5af5079d1982d42e165039e6de7e40a_cgraph" alt=""/></div>
<map name="config__switcher_8c_af5af5079d1982d42e165039e6de7e40a_cgraph" id="config__switcher_8c_af5af5079d1982d42e165039e6de7e40a_cgraph">
<area shape="rect" id="node2" href="hal__storage_8c.html#afad9dd42e1e9762cce888154d22c64ac" title="Start a storage transaction. " alt="" coords="194,87,374,113"/>
<area shape="rect" id="node4" href="hal__storage_8c.html#aad5b764e7c611ff24dbcdd872dc9ae76" title="Load a slot by an action. " alt="" coords="228,289,340,316"/>
<area shape="rect" id="node11" href="hal__storage_8c.html#a5fe9e276fd05e50e4ab9d554ef6f58ca" title="Delete one or all slots. " alt="" coords="673,340,818,367"/>
<area shape="rect" id="node12" href="hal__storage_8c.html#a00b5db14e24d7ada8a42aa6b3f1a1cb7" title="Finish a storage transaction. " alt="" coords="191,239,377,265"/>
<area shape="rect" id="node13" href="hal__storage_8c.html#a75596c64adaa2b8d9104530acc94b094" title="Load a slot by a slot name. " alt="" coords="211,188,357,215"/>
<area shape="rect" id="node15" href="hal__adc_8c.html#a4135bb73c2271b4a27db8d8d81884de7" title="Reload ADC config. " alt="" coords="213,391,355,417"/>
<area shape="rect" id="node23" href="hal__ble_8c.html#accf307974a0046bce38582d0260bf841" title="halBLEReset" alt="" coords="235,441,333,468"/>
<area shape="rect" id="node28" href="hal__serial_8c.html#ab2261f95747ee5806ebdec880d09ca89" title="Reset the serial HID report data. " alt="" coords="942,695,1049,721"/>
<area shape="rect" id="node29" href="task__mouse_8c.html#aa8f5c0436e569589e735c419fc3d0ed8" title="FUNCTIONAL TASK &#45; Trigger mouse action. " alt="" coords="237,492,331,519"/>
<area shape="rect" id="node30" href="task__macros_8c.html#a7acda2dcac23ebfffade8a15b40d219f" title="FUNCTIONAL TASK &#45; Macro execution. " alt="" coords="239,543,329,569"/>
<area shape="rect" id="node31" href="task__kbd_8c.html#a8ff4618047a049178bfb1d60abfefb5d" title="FUNCTIONAL TASK &#45; trigger keyboard actions. " alt="" coords="231,593,337,620"/>
<area shape="rect" id="node33" href="task__joystick_8c.html#a3040132b9cef8e73060fcd9c17dc116b" title="FUNCTIONAL TASK &#45; Trigger joystick action. " alt="" coords="235,644,333,671"/>
<area shape="rect" id="node34" href="config__switcher_8c.html#a083adf41746c3380dcc6dbc099047f2e" title="FUNCTIONAL TASK &#45; Load another slot. " alt="" coords="215,695,353,721"/>
<area shape="rect" id="node35" href="hal__adc_8c.html#a3217185bc86562dee8617ded3872022f" title="FUNCTIONAL TASK &#45; Trigger zero&#45;point calibration of mouthpiece. " alt="" coords="227,745,341,772"/>
<area shape="rect" id="node37" href="hal__storage_8c.html#abc699ff3996d12d3e6bcc9e372b277e0" title="Load one virtual button config for currently loaded slot. " alt="" coords="647,5,843,32"/>
<area shape="rect" id="node38" href="hal__storage_8c.html#aa5da838bef47becbd2b5bd96a60c75b3" title="Get number of currently loaded slot. " alt="" coords="199,847,369,889"/>
<area shape="rect" id="node3" href="hal__storage_8c.html#a606e5842dd354f1fb4a738ba95c6d5d1" title="internal function to init the filesystem if handle is invalid " alt="" coords="459,87,561,113"/>
<area shape="rect" id="node5" href="hal__storage_8c.html#a7e0a934f829b47e2445189dd95e962d6" title="Get the number of stored slots. " alt="" coords="648,289,843,316"/>
<area shape="rect" id="node7" href="hal__storage_8c.html#a3b1b266074bd493fe43dcf980852a422" title="Load a slot by a slot number (starting with 1, 0 is default slot) " alt="" coords="431,239,589,265"/>
<area shape="rect" id="node6" href="hal__storage_8c.html#a4b6566ef5b69c85d422df52435c95d36" title="Internal helper to check for a valid WL handle and the correct tid. " alt="" coords="1159,163,1289,189"/>
<area shape="rect" id="node8" href="hal__storage_8c.html#aed4beb2e1bd8cd78a201fbcb49958cba" title="Create a new default slot. " alt="" coords="663,163,828,189"/>
<area shape="rect" id="node9" href="hal__storage_8c.html#aadf9ff06990d0f0af2eea2e6f2b8082a" title="Store a generalConfig_t struct. " alt="" coords="938,137,1053,164"/>
<area shape="rect" id="node10" href="hal__storage_8c.html#a046daab088cb37e318c07c2728ade9d3" title="Store a virtual button config struct. " alt="" coords="896,188,1095,215"/>
<area shape="rect" id="node14" href="hal__storage_8c.html#aae19bcf97360ccd7af4ddf906ff85141" title="Get the number of a slotname. " alt="" coords="643,75,848,101"/>
<area shape="rect" id="node16" href="hal__adc_8c.html#aee719704e643d27c1faab768cf4bc22e" title="HAL TASK &#45; Threshold task for ADC. " alt="" coords="436,393,584,420"/>
<area shape="rect" id="node17" href="hal__adc_8c.html#a5e0d74baf098e774b0e3aa0dab621987" title="Read out analog voltages, apply sensor gain and deadzone. " alt="" coords="935,391,1056,417"/>
<area shape="rect" id="node18" href="hal__adc_8c.html#a8743abcde6f190545c429f072c16106d" title="Report raw values via serial interface. " alt="" coords="931,492,1059,519"/>
<area shape="rect" id="node21" href="hal__adc_8c.html#acd8f9f6194ebeaa854a791879382b515" title="Process pressure sensor (sip &amp; puff) " alt="" coords="664,441,827,468"/>
<area shape="rect" id="node19" href="hal__serial_8c.html#a8f987ba001c2a39c959a551a94b5df43" title="Send serial bytes to USB&#45;Serial (USB&#45;CDC) " alt="" coords="1143,543,1305,569"/>
<area shape="rect" id="node20" href="hal__serial_8c.html#a132de0978f07044a393cc1f3b5276ced" title="halSerialSwitchTXChannel" alt="" coords="1353,543,1531,569"/>
<area shape="rect" id="node22" href="config__switcher_8c.html#a921538bec34d128a44a748fd5a2c391f" title="Get the current config struct. " alt="" coords="935,441,1056,468"/>
<area shape="rect" id="node24" href="esp__hidd__prf__api_8c.html#a0e953976c5ad30d8508ac11bc61cb6b2" title="esp_hidd_send_mouse\l_value" alt="" coords="433,525,587,566"/>
<area shape="rect" id="node27" href="esp__hidd__prf__api_8c.html#a694ff6418e79f3372b3feba7483e3222" title="esp_hidd_send_keyboard\l_value" alt="" coords="425,450,595,491"/>
<area shape="rect" id="node25" href="hid__dev_8c.html#a8ae7c69dfd4b740534df123a303a8832" title="hid_dev_send_report" alt="" coords="674,543,817,569"/>
<area shape="rect" id="node26" href="hid__dev_8c.html#a1a247bc038a3368cea0bde2303aa8301" title="hid_dev_rpt_by_id" alt="" coords="932,543,1059,569"/>
<area shape="rect" id="node32" href="task__kbd_8c.html#a7d605cb2407a7a7309911c70e28a9884" title="Helper function sending to queues depending on connection type. " alt="" coords="473,593,547,620"/>
<area shape="rect" id="node36" href="hal__adc_8c.html#ae549c157d94729e8b06cb391f0f2c97b" title="Calibration function. " alt="" coords="453,745,567,772"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_af5af5079d1982d42e165039e6de7e40a_icgraph.png" border="0" usemap="#config__switcher_8c_af5af5079d1982d42e165039e6de7e40a_icgraph" alt=""/></div>
<map name="config__switcher_8c_af5af5079d1982d42e165039e6de7e40a_icgraph" id="config__switcher_8c_af5af5079d1982d42e165039e6de7e40a_icgraph">
<area shape="rect" id="node2" href="config__switcher_8h.html#aafed047c8d04b814a85239e031cbad7b" title="Initializing the config switching functionality. " alt="" coords="191,5,317,32"/>
<area shape="rect" id="node3" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="365,5,444,32"/>
</map>
</div>

</div>
</div>
<a id="a4c2e410d8032c65c0700c6ca07429074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c2e410d8032c65c0700c6ca07429074">&#9670;&nbsp;</a></span>configUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t configUpdate </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trigger a config update. </p>
<p>This method is simply sending an "__UPDATE" command to the config_switcher queue to trigger an update by re-loading the currentConfig.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="common_8h.html#a4701c432a28c389e4b8557f2fa3323d1" title="Queue to receive config changing commands. ">config_switcher</a> </dd>
<dd>
currentConfig </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, ESP_FAIL otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00131">131</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00163">configUpdateVB()</a>, and <a class="el" href="task__commands_8c_source.html#l01360">task_commands()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_a4c2e410d8032c65c0700c6ca07429074_icgraph.png" border="0" usemap="#config__switcher_8c_a4c2e410d8032c65c0700c6ca07429074_icgraph" alt=""/></div>
<map name="config__switcher_8c_a4c2e410d8032c65c0700c6ca07429074_icgraph" id="config__switcher_8c_a4c2e410d8032c65c0700c6ca07429074_icgraph">
<area shape="rect" id="node2" href="config__switcher_8h.html#a20db6aabb98f5c9c7cea48e950bada5b" title="Update one virtual button. " alt="" coords="152,5,269,32"/>
<area shape="rect" id="node3" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="317,31,436,57"/>
<area shape="rect" id="node4" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="Init the command parser. " alt="" coords="497,5,629,32"/>
<area shape="rect" id="node6" href="task__commands_8h.html#a26091155b4d85093239033d689f363d0" title="Restart the command parser task. " alt="" coords="484,56,641,83"/>
<area shape="rect" id="node5" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="689,5,768,32"/>
</map>
</div>

</div>
</div>
<a id="a20db6aabb98f5c9c7cea48e950bada5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20db6aabb98f5c9c7cea48e950bada5b">&#9670;&nbsp;</a></span>configUpdateVB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t configUpdateVB </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="common_8h.html#ac27b6f4710923c6689834e86aea228ac">command_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>vb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update one virtual button. </p>
<p>This function is used to update one virtual button config. For example it is triggered by "AT BM xx" and the following AT command. It saves the param pointer to the update param array and calls configUpdate to trigger the reload. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="config__switcher_8c.html#a4c2e410d8032c65c0700c6ca07429074" title="Trigger a config update. ">configUpdate</a> </dd>
<dd>
<a class="el" href="config__switcher_8c.html#aceb033b9bef9bb354a3b2c4734b4ec9d" title="Array of pointers to FUNCTIONAL task parameters (for updating current config) ">currentTaskParametersUpdate</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">param</td><td>FUNCTIONAL task parameter memory </td></tr>
    <tr><td class="paramname">type</td><td>Type of new VB command </td></tr>
    <tr><td class="paramname">vb</td><td>Number of virtualbutton to update </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, ESP_FAIL otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00163">163</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__commands_8c_source.html#l01360">task_commands()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_a20db6aabb98f5c9c7cea48e950bada5b_cgraph.png" border="0" usemap="#config__switcher_8c_a20db6aabb98f5c9c7cea48e950bada5b_cgraph" alt=""/></div>
<map name="config__switcher_8c_a20db6aabb98f5c9c7cea48e950bada5b_cgraph" id="config__switcher_8c_a20db6aabb98f5c9c7cea48e950bada5b_cgraph">
<area shape="rect" id="node2" href="config__switcher_8c.html#a4c2e410d8032c65c0700c6ca07429074" title="Trigger a config update. " alt="" coords="171,5,269,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_a20db6aabb98f5c9c7cea48e950bada5b_icgraph.png" border="0" usemap="#config__switcher_8c_a20db6aabb98f5c9c7cea48e950bada5b_icgraph" alt=""/></div>
<map name="config__switcher_8c_a20db6aabb98f5c9c7cea48e950bada5b_icgraph" id="config__switcher_8c_a20db6aabb98f5c9c7cea48e950bada5b_icgraph">
<area shape="rect" id="node2" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="171,31,289,57"/>
<area shape="rect" id="node3" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="Init the command parser. " alt="" coords="350,5,482,32"/>
<area shape="rect" id="node5" href="task__commands_8h.html#a26091155b4d85093239033d689f363d0" title="Restart the command parser task. " alt="" coords="337,56,495,83"/>
<area shape="rect" id="node4" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="543,5,621,32"/>
</map>
</div>

</div>
</div>
<a id="a083adf41746c3380dcc6dbc099047f2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a083adf41746c3380dcc6dbc099047f2e">&#9670;&nbsp;</a></span>task_configswitcher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task_configswitcher </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="config__switcher_8h.html#aa6d38946df351bfaec1994fdb081e7db">taskConfigSwitcherConfig_t</a> *&#160;</td>
          <td class="paramname"><em>param</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>FUNCTIONAL TASK - Load another slot. </p>
<p>This task is used to switch the configuration to another slot. It is possible to load a slot by name or a previous/next/default slot.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">param</td><td>Task configuration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="config__switcher_8h.html#aa6d38946df351bfaec1994fdb081e7db" title="Parameter for functional task task_configswitcher. ">taskConfigSwitcherConfig_t</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00444">444</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00198">configSwitcherTask()</a>, and <a class="el" href="task__commands_8c_source.html#l00394">doStorageParsing()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_a083adf41746c3380dcc6dbc099047f2e_icgraph.png" border="0" usemap="#config__switcher_8c_a083adf41746c3380dcc6dbc099047f2e_icgraph" alt=""/></div>
<map name="config__switcher_8c_a083adf41746c3380dcc6dbc099047f2e_icgraph" id="config__switcher_8c_a083adf41746c3380dcc6dbc099047f2e_icgraph">
<area shape="rect" id="node2" href="config__switcher_8c.html#af5af5079d1982d42e165039e6de7e40a" title="CONTINOUS TASK &#45; Config switcher task, internal config reloading. " alt="" coords="192,5,329,32"/>
<area shape="rect" id="node5" href="task__commands_8c.html#a69b0c55558b32caa21407de8e2277be9" title="doStorageParsing" alt="" coords="198,56,323,83"/>
<area shape="rect" id="node3" href="config__switcher_8h.html#aafed047c8d04b814a85239e031cbad7b" title="Initializing the config switching functionality. " alt="" coords="377,5,504,32"/>
<area shape="rect" id="node4" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="757,31,836,57"/>
<area shape="rect" id="node6" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="381,56,500,83"/>
<area shape="rect" id="node7" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="Init the command parser. " alt="" coords="565,56,697,83"/>
<area shape="rect" id="node8" href="task__commands_8h.html#a26091155b4d85093239033d689f363d0" title="Restart the command parser task. " alt="" coords="552,107,709,133"/>
</map>
</div>

</div>
</div>
<a id="a68e6ddb2557b0bf3e2d84952feb0b5a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68e6ddb2557b0bf3e2d84952feb0b5a5">&#9670;&nbsp;</a></span>task_configswitcher_getAT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t task_configswitcher_getAT </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cfg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reverse Parsing - get AT command for configswitcher VB. </p>
<p>This function parses the current configuration of a virtual button to an AT command used to print the configuration. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>Output string, where the full AT command will be stored </td></tr>
    <tr><td class="paramname">cfg</td><td>Pointer to current cfgswitcher configuration, used to parse. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if everything went fine, ESP_FAIL otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00111">111</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__commands_8c_source.html#l01555">printAllSlots()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8c_a68e6ddb2557b0bf3e2d84952feb0b5a5_icgraph.png" border="0" usemap="#config__switcher_8c_a68e6ddb2557b0bf3e2d84952feb0b5a5_icgraph" alt=""/></div>
<map name="config__switcher_8c_a68e6ddb2557b0bf3e2d84952feb0b5a5_icgraph" id="config__switcher_8c_a68e6ddb2557b0bf3e2d84952feb0b5a5_icgraph">
<area shape="rect" id="node2" href="task__commands_8c.html#ad59215648a26578c22baa7ceae099e0e" title="Print the current slot configurations (general settings + VBs) " alt="" coords="192,157,284,184"/>
<area shape="rect" id="node3" href="task__commands_8c.html#acea81ba8a182ae78feb2db6418fc1806" title="sendErrorBack" alt="" coords="332,120,440,147"/>
<area shape="rect" id="node10" href="task__commands_8c.html#a7f6500be563a3dce7f0854fceed02fab" title="doGeneralCmdParsing" alt="" coords="509,208,662,235"/>
<area shape="rect" id="node4" href="task__commands_8c.html#a2ad28759e53bb5082853d8d004767115" title="doMouthpieceSettingsParsing" alt="" coords="488,5,683,32"/>
<area shape="rect" id="node9" href="task__commands_8c.html#afc7ebe31a124c2102f8b41577b6dc5b0" title="doJoystickParsing" alt="" coords="521,56,650,83"/>
<area shape="rect" id="node11" href="task__commands_8c.html#ac3c72c089d32dea93c45f4f9f8d1f244" title="doKeyboardParsing" alt="" coords="518,107,653,133"/>
<area shape="rect" id="node12" href="task__commands_8c.html#a580d9f6a840975525358033a35f761d0" title="doMouseParsing" alt="" coords="526,157,645,184"/>
<area shape="rect" id="node5" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="731,107,849,133"/>
<area shape="rect" id="node6" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="Init the command parser. " alt="" coords="910,81,1042,108"/>
<area shape="rect" id="node8" href="task__commands_8h.html#a26091155b4d85093239033d689f363d0" title="Restart the command parser task. " alt="" coords="897,132,1055,159"/>
<area shape="rect" id="node7" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="1103,81,1181,108"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="abd2fb9b048f1de98ee98dd54077541c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd2fb9b048f1de98ee98dd54077541c2">&#9670;&nbsp;</a></span>configswitcher_handle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TaskHandle_t configswitcher_handle</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Task handle for the CONTINOUS task responsible for config switching </p>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00083">83</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00510">configSwitcherInit()</a>.</p>

</div>
</div>
<a id="a73c577cdbcaa9439f9458a9e5d39c143"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73c577cdbcaa9439f9458a9e5d39c143">&#9670;&nbsp;</a></span>currentConfigLoaded</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a1d17932316265a53a6982a2526a4cada">generalConfig_t</a> currentConfigLoaded</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Currently loaded configuration. </p>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00086">86</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00098">configGetCurrent()</a>.</p>

</div>
</div>
<a id="a04ff31fa74901c29c54c862980d47823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04ff31fa74901c29c54c862980d47823">&#9670;&nbsp;</a></span>currentTaskParameters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* currentTaskParameters[<a class="el" href="common_8h.html#aee89b7237c851b73f694c2fb1530cbeb">NUMBER_VIRTUALBUTTONS</a> *4]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array of pointers to FUNCTIONAL task parameters. </p>
<p>This array contains pointers to memory, which is allocated here. Each time a task switch is triggered, the parameters are loaded from hal_storage and saved to an allocated memory area. These pointers are used to pass the parameters to the functional tasks and free this memory after unloading/deleting functional tasks. </p>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00063">63</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00510">configSwitcherInit()</a>, and <a class="el" href="config__switcher_8c_source.html#l00198">configSwitcherTask()</a>.</p>

</div>
</div>
<a id="aceb033b9bef9bb354a3b2c4734b4ec9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceb033b9bef9bb354a3b2c4734b4ec9d">&#9670;&nbsp;</a></span>currentTaskParametersUpdate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* currentTaskParametersUpdate[<a class="el" href="common_8h.html#aee89b7237c851b73f694c2fb1530cbeb">NUMBER_VIRTUALBUTTONS</a> *4]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array of pointers to FUNCTIONAL task parameters (for updating current config) </p>
<p>This array contains pointers to memory, which is allocated externally. Pointers here have the same function as in currentTaskParameters, except they are used ONLY during config <b>UPDATE</b>.</p>
<p>If an external module wants to update a virtual button config without loading a full slot, following steps are necessary:&lt;br&lt;</p><ul>
<li>Allocate memory for the FUNCTIONAL task parameters</li>
<li>Save this pointer to this array here &amp; fill parameter with data</li>
<li>Set currentConfigLoaded.virtualButtonCommand[vb] accordingly</li>
<li>Request slot update via config_switcher queue</li>
</ul>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Maybe this information should be moved to the corresponding function. </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00080">80</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00510">configSwitcherInit()</a>, <a class="el" href="config__switcher_8c_source.html#l00198">configSwitcherTask()</a>, and <a class="el" href="config__switcher_8c_source.html#l00163">configUpdateVB()</a>.</p>

</div>
</div>
<a id="a67130d7a5483b1a7cee6badb08e0dbc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67130d7a5483b1a7cee6badb08e0dbc6">&#9670;&nbsp;</a></span>currentTasks</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TaskHandle_t currentTasks[<a class="el" href="common_8h.html#aee89b7237c851b73f694c2fb1530cbeb">NUMBER_VIRTUALBUTTONS</a> *4]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array containing all currently running FUNCTIONAL task handles. </p>
<p>This array contains task handles, one for each virtual button. NULL if there is no task loaded, the task handle otherwise. Is used to delete running tasks on a config switch </p>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00054">54</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00198">configSwitcherTask()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
