<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLipMouse/FABI ESP32 firmware: /home/beni/sync/Projects/FH/FLipMouse-esp32/main/ble_hid/hal_ble.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLipMouse/FABI ESP32 firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li><li class="navelem"><a class="el" href="dir_c5f89bf253062bf5ee4e081264477f0f.html">ble_hid</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">hal_ble.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file is a C compatible wrapper for Neil Kolbans CPP utils.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;freertos/FreeRTOS.h&gt;</code><br />
<code>#include &lt;freertos/event_groups.h&gt;</code><br />
<code>#include &lt;freertos/queue.h&gt;</code><br />
<code>#include &lt;esp_log.h&gt;</code><br />
<code>#include &lt;<a class="el" href="keyboard_8h_source.html">keyboard.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
</div>
<p><a href="hal__ble_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6919311894de84aa70b02c46cf822dde"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hal__ble_8h.html#a6919311894de84aa70b02c46cf822dde">halBLESetPairing</a> (uint8_t enable)</td></tr>
<tr class="memdesc:a6919311894de84aa70b02c46cf822dde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activate/deactivate pairing mode.  <a href="#a6919311894de84aa70b02c46cf822dde">More...</a><br /></td></tr>
<tr class="separator:a6919311894de84aa70b02c46cf822dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c6787d5b7e82e56119ed95ae9ddb98d"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hal__ble_8h.html#a5c6787d5b7e82e56119ed95ae9ddb98d">halBLEIsConnected</a> (void)</td></tr>
<tr class="memdesc:a5c6787d5b7e82e56119ed95ae9ddb98d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get connection status.  <a href="#a5c6787d5b7e82e56119ed95ae9ddb98d">More...</a><br /></td></tr>
<tr class="separator:a5c6787d5b7e82e56119ed95ae9ddb98d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ade7df97a34fa89e0f2db7f5d2614de"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hal__ble_8h.html#a1ade7df97a34fa89e0f2db7f5d2614de">halBLEEnDisable</a> (int onoff)</td></tr>
<tr class="memdesc:a1ade7df97a34fa89e0f2db7f5d2614de"><td class="mdescLeft">&#160;</td><td class="mdescRight">En- or Disable BLE interface.  <a href="#a1ade7df97a34fa89e0f2db7f5d2614de">More...</a><br /></td></tr>
<tr class="separator:a1ade7df97a34fa89e0f2db7f5d2614de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accf307974a0046bce38582d0260bf841"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hal__ble_8h.html#accf307974a0046bce38582d0260bf841">halBLEReset</a> (uint8_t exceptDevice)</td></tr>
<tr class="memdesc:accf307974a0046bce38582d0260bf841"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the BLE data.  <a href="#accf307974a0046bce38582d0260bf841">More...</a><br /></td></tr>
<tr class="separator:accf307974a0046bce38582d0260bf841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559e9af2167a8f1b05a8304234418ed3"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hal__ble_8h.html#a559e9af2167a8f1b05a8304234418ed3">halBLEInit</a> (uint8_t enableKeyboard, uint8_t enableMouse, uint8_t enableJoystick)</td></tr>
<tr class="memdesc:a559e9af2167a8f1b05a8304234418ed3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main init function to start HID interface (C interface)  <a href="#a559e9af2167a8f1b05a8304234418ed3">More...</a><br /></td></tr>
<tr class="separator:a559e9af2167a8f1b05a8304234418ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4d504fcad8a2fb54bd8af573af7d4834"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hal__ble_8h.html#a4d504fcad8a2fb54bd8af573af7d4834">hid_ble</a></td></tr>
<tr class="memdesc:a4d504fcad8a2fb54bd8af573af7d4834"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue for sending mouse reports.  <a href="#a4d504fcad8a2fb54bd8af573af7d4834">More...</a><br /></td></tr>
<tr class="separator:a4d504fcad8a2fb54bd8af573af7d4834"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file is a C compatible wrapper for Neil Kolbans CPP utils. </p>
<p>It receives data from hid_ble queue, which is equal to hid_usb. C++ classes are instantiated from here.</p>
<dl class="section note"><dt>Note</dt><dd>Thank you very much Neil Kolban and chegewara for this impressive work! </dd></dl>

<p class="definition">Definition in file <a class="el" href="hal__ble_8h_source.html">hal_ble.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1ade7df97a34fa89e0f2db7f5d2614de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ade7df97a34fa89e0f2db7f5d2614de">&#9670;&nbsp;</a></span>halBLEEnDisable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t halBLEEnDisable </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>onoff</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>En- or Disable BLE interface. </p>
<p>This method is used to enable or disable the BLE interface. Currently, the ESP32 cannot use WiFi and BLE simultaneously. Therefore, when enabling wifi, it is necessary to disable BLE prior calling taskWebGUIEnDisable.</p>
<dl class="section note"><dt>Note</dt><dd>Calling this method prior to initializing BLE via halBLEInit will result in an error! </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, ESP_FAIL otherwise </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">onoff</td><td>If != 0, switch on BLE, switch off if 0. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HID__kbdmousejoystick_8cpp_source.html#l00837">837</a> of file <a class="el" href="HID__kbdmousejoystick_8cpp_source.html">HID_kbdmousejoystick.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="flipmouse__fabi__esp32__kbdmouse__main_8c_source.html#l00089">app_main()</a>, and <a class="el" href="task__webgui_8c_source.html#l00535">wifi_timer_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hal__ble_8h_a1ade7df97a34fa89e0f2db7f5d2614de_icgraph.png" border="0" usemap="#hal__ble_8h_a1ade7df97a34fa89e0f2db7f5d2614de_icgraph" alt=""/></div>
<map name="hal__ble_8h_a1ade7df97a34fa89e0f2db7f5d2614de_icgraph" id="hal__ble_8h_a1ade7df97a34fa89e0f2db7f5d2614de_icgraph">
<area shape="rect" id="node2" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="488,5,567,32"/>
<area shape="rect" id="node3" href="task__webgui_8c.html#ae5ad2f76f20781fd8c89e542bcc8a551" title="Timer callback for disabling wifi. " alt="" coords="177,31,276,57"/>
<area shape="rect" id="node4" href="task__webgui_8h.html#a669b9245d5040c0162481f7b24dbeea7" title="Init the web / DNS server and the web gui. " alt="" coords="324,31,440,57"/>
</map>
</div>

</div>
</div>
<a id="a559e9af2167a8f1b05a8304234418ed3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a559e9af2167a8f1b05a8304234418ed3">&#9670;&nbsp;</a></span>halBLEInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t halBLEInit </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>enableKeyboard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>enableMouse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>enableJoystick</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main init function to start HID interface (C interface) </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="hal__ble_8h.html#a4d504fcad8a2fb54bd8af573af7d4834" title="Queue for sending mouse reports. ">hid_ble</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="HID__kbdmousejoystick_8cpp_source.html#l00812">812</a> of file <a class="el" href="HID__kbdmousejoystick_8cpp_source.html">HID_kbdmousejoystick.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="flipmouse__fabi__esp32__kbdmouse__main_8c_source.html#l00089">app_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hal__ble_8h_a559e9af2167a8f1b05a8304234418ed3_cgraph.png" border="0" usemap="#hal__ble_8h_a559e9af2167a8f1b05a8304234418ed3_cgraph" alt=""/></div>
<map name="hal__ble_8h_a559e9af2167a8f1b05a8304234418ed3_cgraph" id="hal__ble_8h_a559e9af2167a8f1b05a8304234418ed3_cgraph">
<area shape="rect" id="node2" href="classTask.html#afe0f5594c56b8cc7ac96c2198d5d81b4" title="Set the stack size of the task. " alt="" coords="136,5,273,32"/>
<area shape="rect" id="node3" href="classTask.html#a6f13d13787e21dc929b61d112b863433" title="Start an instance of the task. " alt="" coords="162,56,247,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hal__ble_8h_a559e9af2167a8f1b05a8304234418ed3_icgraph.png" border="0" usemap="#hal__ble_8h_a559e9af2167a8f1b05a8304234418ed3_icgraph" alt=""/></div>
<map name="hal__ble_8h_a559e9af2167a8f1b05a8304234418ed3_icgraph" id="hal__ble_8h_a559e9af2167a8f1b05a8304234418ed3_icgraph">
<area shape="rect" id="node2" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="136,5,215,32"/>
</map>
</div>

</div>
</div>
<a id="a5c6787d5b7e82e56119ed95ae9ddb98d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c6787d5b7e82e56119ed95ae9ddb98d">&#9670;&nbsp;</a></span>halBLEIsConnected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t halBLEIsConnected </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get connection status. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Add interface to disable BLE &amp; free memory! (see long button handler in main) </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 if not connected, != 0 if connected</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Add interface to disable BLE &amp; free memory! (see long button handler in main) </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 if not connected, != 0 if connected </dd></dl>

<p class="definition">Definition at line <a class="el" href="HID__kbdmousejoystick_8cpp_source.html#l00805">805</a> of file <a class="el" href="HID__kbdmousejoystick_8cpp_source.html">HID_kbdmousejoystick.cpp</a>.</p>

</div>
</div>
<a id="accf307974a0046bce38582d0260bf841"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accf307974a0046bce38582d0260bf841">&#9670;&nbsp;</a></span>halBLEReset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void halBLEReset </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>exceptDevice</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the BLE data. </p>
<p>Used for slot/config switchers. It resets the keycode array and sets all HID reports to 0 (release all keys, avoiding sticky keys on a config change) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exceptDevice</td><td>if you want to reset only a part of the devices, set flags accordingly:</td></tr>
  </table>
  </dd>
</dl>
<p>(1&lt;&lt;0) excepts keyboard (1&lt;&lt;1) excepts joystick (1&lt;&lt;2) excepts mouse If nothing is set (exceptDevice = 0) all are reset </p>

<p class="definition">Definition at line <a class="el" href="HID__kbdmousejoystick_8cpp_source.html#l00864">864</a> of file <a class="el" href="HID__kbdmousejoystick_8cpp_source.html">HID_kbdmousejoystick.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00141">configTimerCallback()</a>, and <a class="el" href="task__commands_8c_source.html#l00797">doGeneralCmdParsing()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hal__ble_8h_accf307974a0046bce38582d0260bf841_icgraph.png" border="0" usemap="#hal__ble_8h_accf307974a0046bce38582d0260bf841_icgraph" alt=""/></div>
<map name="hal__ble_8h_accf307974a0046bce38582d0260bf841_icgraph" id="hal__ble_8h_accf307974a0046bce38582d0260bf841_icgraph">
<area shape="rect" id="node2" href="config__switcher_8c.html#a634f0179096daf06df87ba5cd1789d6b" title="configTimerCallback" alt="" coords="158,5,299,32"/>
<area shape="rect" id="node5" href="task__commands_8c.html#a7f6500be563a3dce7f0854fceed02fab" title="doGeneralCmdParsing" alt="" coords="152,56,305,83"/>
<area shape="rect" id="node3" href="config__switcher_8h.html#aafed047c8d04b814a85239e031cbad7b" title="Initializing the config switching functionality. " alt="" coords="353,5,480,32"/>
<area shape="rect" id="node4" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="733,31,812,57"/>
<area shape="rect" id="node6" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="357,56,476,83"/>
<area shape="rect" id="node7" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="Init the command parser. " alt="" coords="541,56,673,83"/>
<area shape="rect" id="node8" href="task__commands_8h.html#a26091155b4d85093239033d689f363d0" title="Restart the command parser task. " alt="" coords="528,107,685,133"/>
</map>
</div>

</div>
</div>
<a id="a6919311894de84aa70b02c46cf822dde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6919311894de84aa70b02c46cf822dde">&#9670;&nbsp;</a></span>halBLESetPairing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t halBLESetPairing </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activate/deactivate pairing mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">enable</td><td>If set to != 0, pairing will be enabled. Disabled if == 0 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, ESP_FAIL otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="HID__kbdmousejoystick_8cpp_source.html#l00790">790</a> of file <a class="el" href="HID__kbdmousejoystick_8cpp_source.html">HID_kbdmousejoystick.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4d504fcad8a2fb54bd8af573af7d4834"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d504fcad8a2fb54bd8af573af7d4834">&#9670;&nbsp;</a></span>hid_ble</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t hid_ble</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queue for sending mouse reports. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="common_8h.html#a717ff1d55fb710bbebe9addae27d7258" title="One HID command, maybe an element of a command chain. ">hid_cmd_t</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="flipmouse__fabi__esp32__kbdmouse__main_8c_source.html#l00059">59</a> of file <a class="el" href="flipmouse__fabi__esp32__kbdmouse__main_8c_source.html">flipmouse_fabi_esp32_kbdmouse_main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__commands_8c_source.html#l00125">checkqueues()</a>, <a class="el" href="task__commands_8c_source.html#l00489">doJoystickParsing()</a>, <a class="el" href="hal__adc_8c_source.html#l01073">halAdcInit()</a>, <a class="el" href="hal__adc_8c_source.html#l00408">halAdcProcessPressure()</a>, <a class="el" href="task__commands_8c_source.html#l00139">sendHIDCmd()</a>, and <a class="el" href="task__hid_8c_source.html#l00069">task_hid()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
