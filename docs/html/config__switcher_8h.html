<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLipMouse/FABI ESP32 firmware: /home/beni/sync/Projects/FH/FLipMouse-esp32/main/config_switcher.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLipMouse/FABI ESP32 firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">config_switcher.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>CONTINOUS TASK + FUNCTIONAL TASK - This module takes care of configuration loading.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;esp_log.h&quot;</code><br />
<code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tones_8h_source.html">tones.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hal__adc_8h_source.html">hal_adc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hal__storage_8h_source.html">hal_storage.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hal__io_8h_source.html">hal_io.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hal__ble_8h_source.html">hal_ble.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hal__serial_8h_source.html">hal_serial.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="task__hid_8h_source.html">task_hid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="task__vb_8h_source.html">task_vb.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="task__debouncer_8h_source.html">task_debouncer.h</a>&quot;</code><br />
</div>
<p><a href="config__switcher_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2eb976695a3c5db9b4ddf53ac58bd0b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8h.html#a2eb976695a3c5db9b4ddf53ac58bd0b1">TASK_CONFIGSWITCHER_STACKSIZE</a>&#160;&#160;&#160;2048</td></tr>
<tr class="separator:a2eb976695a3c5db9b4ddf53ac58bd0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aafed047c8d04b814a85239e031cbad7b"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8h.html#aafed047c8d04b814a85239e031cbad7b">configSwitcherInit</a> (void)</td></tr>
<tr class="memdesc:aafed047c8d04b814a85239e031cbad7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializing the config switching functionality.  <a href="#aafed047c8d04b814a85239e031cbad7b">More...</a><br /></td></tr>
<tr class="separator:aafed047c8d04b814a85239e031cbad7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a921538bec34d128a44a748fd5a2c391f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a1d17932316265a53a6982a2526a4cada">generalConfig_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8h.html#a921538bec34d128a44a748fd5a2c391f">configGetCurrent</a> (void)</td></tr>
<tr class="memdesc:a921538bec34d128a44a748fd5a2c391f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current config struct.  <a href="#a921538bec34d128a44a748fd5a2c391f">More...</a><br /></td></tr>
<tr class="separator:a921538bec34d128a44a748fd5a2c391f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c2e410d8032c65c0700c6ca07429074"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8h.html#a4c2e410d8032c65c0700c6ca07429074">configUpdate</a> (void)</td></tr>
<tr class="memdesc:a4c2e410d8032c65c0700c6ca07429074"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request config update.  <a href="#a4c2e410d8032c65c0700c6ca07429074">More...</a><br /></td></tr>
<tr class="separator:a4c2e410d8032c65c0700c6ca07429074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27ed39a214ff60cc13af7058e8f4722e"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="config__switcher_8h.html#a27ed39a214ff60cc13af7058e8f4722e">configUpdateWaitStable</a> (void)</td></tr>
<tr class="memdesc:a27ed39a214ff60cc13af7058e8f4722e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until current configuration is stable.  <a href="#a27ed39a214ff60cc13af7058e8f4722e">More...</a><br /></td></tr>
<tr class="separator:a27ed39a214ff60cc13af7058e8f4722e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>CONTINOUS TASK + FUNCTIONAL TASK - This module takes care of configuration loading. </p>
<p>The config_switcher module is used to control all tasks assigned to virtual buttons (called FUNCTIONAL TASKS). If a new configuration should be loaded from the storage, all previously loaded tasks are deleted and new tasks are loaded.</p>
<p>A slot configuration is provided by the config_storage, which is controlled by this module.</p>
<p>task_configswitcher is the FUNCTIONAL TASK for triggering a slot switch. configSwitcherTask is the CONTINOUS TASK which monitors the queue for any config switching action.</p>
<dl class="section note"><dt>Note</dt><dd>If you want to add a new FUNCTIONAL TASK, please include headers here &amp; add loading functionality to configSwitcherTask. </dd></dl>

<p class="definition">Definition in file <a class="el" href="config__switcher_8h_source.html">config_switcher.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a2eb976695a3c5db9b4ddf53ac58bd0b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb976695a3c5db9b4ddf53ac58bd0b1">&#9670;&nbsp;</a></span>TASK_CONFIGSWITCHER_STACKSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TASK_CONFIGSWITCHER_STACKSIZE&#160;&#160;&#160;2048</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Stacksize for functional task task_configswitcher. </p><dl class="section see"><dt>See also</dt><dd>task_configswitcher </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8h_source.html#l00064">64</a> of file <a class="el" href="config__switcher_8h_source.html">config_switcher.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a921538bec34d128a44a748fd5a2c391f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a921538bec34d128a44a748fd5a2c391f">&#9670;&nbsp;</a></span>configGetCurrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a1d17932316265a53a6982a2526a4cada">generalConfig_t</a>* configGetCurrent </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current config struct. </p>
<p>This method is used to get a reference to the current config struct. The caller can use this reference to change the configuration and update the config afterwards (via the config_switcher queue).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="common_8h.html#a4701c432a28c389e4b8557f2fa3323d1" title="Queue to receive config changing commands. ">config_switcher</a> </dd>
<dd>
currentConfig </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the current config struct</dd></dl>
<p>This method is used to get a reference to the current config struct. The caller can use this reference to change the configuration and update the config afterwards (via the config_switcher queue).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="common_8h.html#a4701c432a28c389e4b8557f2fa3323d1" title="Queue to receive config changing commands. ">config_switcher</a> </dd>
<dd>
<a class="el" href="config__switcher_8c.html#a73c577cdbcaa9439f9458a9e5d39c143">currentConfigLoaded</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the current config struct </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00082">82</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__debouncer_8c_source.html#l00180">debouncerCallback()</a>, <a class="el" href="task__commands_8c_source.html#l00797">doGeneralCmdParsing()</a>, <a class="el" href="task__commands_8c_source.html#l00639">doInfraredParsing()</a>, <a class="el" href="task__commands_8c_source.html#l01091">doKeyboardParsing()</a>, <a class="el" href="task__commands_8c_source.html#l01464">doMouseParsing()</a>, <a class="el" href="task__commands_8c_source.html#l00149">doMouthpieceSettingsParsing()</a>, <a class="el" href="hal__adc_8c_source.html#l00408">halAdcProcessPressure()</a>, <a class="el" href="hal__io_8c_source.html#l00322">halIOBuzzerTask()</a>, <a class="el" href="hal__io_8c_source.html#l00550">halIOInit()</a>, <a class="el" href="hal__io_8c_source.html#l00383">halIOLEDTask()</a>, <a class="el" href="task__infrared_8c_source.html#l00270">infrared_set_edge_timeout()</a>, <a class="el" href="task__commands_8c_source.html#l01814">storeSlot()</a>, and <a class="el" href="task__debouncer_8c_source.html#l00305">task_debouncer()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8h_a921538bec34d128a44a748fd5a2c391f_icgraph.png" border="0" usemap="#config__switcher_8h_a921538bec34d128a44a748fd5a2c391f_icgraph" alt=""/></div>
<map name="config__switcher_8h_a921538bec34d128a44a748fd5a2c391f_icgraph" id="config__switcher_8h_a921538bec34d128a44a748fd5a2c391f_icgraph">
<area shape="rect" id="node2" href="task__debouncer_8c.html#a4a76abdbb849aa0bbc66aa001c6f4af9" title="Timer callback for debouncing. " alt="" coords="195,436,329,463"/>
<area shape="rect" id="node4" href="task__debouncer_8h.html#a79d88e490be7198b9cc37556c66b837b" title="Debouncing main task. " alt="" coords="633,436,748,463"/>
<area shape="rect" id="node6" href="task__commands_8c.html#a7f6500be563a3dce7f0854fceed02fab" title="doGeneralCmdParsing" alt="" coords="614,132,767,159"/>
<area shape="rect" id="node10" href="task__commands_8c.html#a69b696a381aec817e617d2b33da045f5" title="doInfraredParsing" alt="" coords="409,385,533,412"/>
<area shape="rect" id="node11" href="task__commands_8c.html#a30b4c99ded33188ea79b55159263bc7b" title="doKeyboardParsing" alt="" coords="623,233,758,260"/>
<area shape="rect" id="node12" href="task__commands_8c.html#ac722e0888b76642db875d54ff8ef6476" title="doMouseParsing" alt="" coords="412,335,531,361"/>
<area shape="rect" id="node13" href="task__commands_8c.html#ab58b3673b001ca270dd4a17bb01db6b4" title="doMouthpieceSettingsParsing" alt="" coords="593,284,788,311"/>
<area shape="rect" id="node14" href="hal__adc_8c.html#a78419739020988cffc83ffcbc7103b05" title="Process pressure sensor (sip &amp; puff) " alt="" coords="181,537,343,564"/>
<area shape="rect" id="node20" href="hal__io_8c.html#a5c30b3b4a88e8f23489485659d53c7c0" title="HAL TASK &#45; Buzzer update task. " alt="" coords="201,5,323,32"/>
<area shape="rect" id="node21" href="hal__io_8h.html#aa5ee74913a09cba6dca62bfdc9f8342b" title="Initializing IO HAL. " alt="" coords="436,31,507,57"/>
<area shape="rect" id="node22" href="hal__io_8c.html#ad83b58c9ee836526a874392c0757f42d" title="HAL TASK &#45; LED update task. " alt="" coords="208,588,316,615"/>
<area shape="rect" id="node23" href="task__infrared_8h.html#a085c1313247cfb56fc663527aa3bdb49" title="Set the time between two IR edges which will trigger the timeout (end of received command) ..." alt="" coords="175,639,349,665"/>
<area shape="rect" id="node24" href="task__commands_8c.html#a78b669ea961463eb05d2016e0b41ff86" title="Save current config to flash. " alt="" coords="225,107,299,133"/>
<area shape="rect" id="node3" href="task__debouncer_8c.html#a2d41ed2a246a1b8d4ee5510262001e50" title="Start a debouncing timer with given debounce time and VB number. " alt="" coords="431,436,512,463"/>
<area shape="rect" id="node5" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="1231,411,1309,437"/>
<area shape="rect" id="node7" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="847,259,966,285"/>
<area shape="rect" id="node8" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="Init the command parser. " alt="" coords="1038,259,1170,285"/>
<area shape="rect" id="node9" href="task__commands_8h.html#a26091155b4d85093239033d689f363d0" title="Restart the command parser task. " alt="" coords="1025,309,1183,336"/>
<area shape="rect" id="node15" href="hal__adc_8c.html#aee719704e643d27c1faab768cf4bc22e" title="HAL TASK &#45; Threshold task for ADC. " alt="" coords="397,537,545,564"/>
<area shape="rect" id="node16" href="hal__adc_8h.html#a4135bb73c2271b4a27db8d8d81884de7" title="Reload ADC config. " alt="" coords="619,512,762,539"/>
<area shape="rect" id="node17" href="config__switcher_8c.html#a634f0179096daf06df87ba5cd1789d6b" title="configTimerCallback" alt="" coords="836,461,977,488"/>
<area shape="rect" id="node19" href="hal__adc_8h.html#a6f0d302f35e5b7f7a1144f0ddace35d2" title="Init the ADC driver module. " alt="" coords="867,512,947,539"/>
<area shape="rect" id="node18" href="config__switcher_8h.html#aafed047c8d04b814a85239e031cbad7b" title="Initializing the config switching functionality. " alt="" coords="1041,461,1167,488"/>
<area shape="rect" id="node25" href="task__commands_8c.html#acea81ba8a182ae78feb2db6418fc1806" title="sendErrorBack" alt="" coords="417,183,525,209"/>
<area shape="rect" id="node27" href="task__commands_8c.html#a770d94bfbf3d8c959ac003816d2b41fe" title="doStorageParsing" alt="" coords="409,81,534,108"/>
<area shape="rect" id="node26" href="task__commands_8c.html#a2f0908e9a181ce6f837e67d074a2b723" title="doJoystickParsing" alt="" coords="626,183,755,209"/>
</map>
</div>

</div>
</div>
<a id="aafed047c8d04b814a85239e031cbad7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafed047c8d04b814a85239e031cbad7b">&#9670;&nbsp;</a></span>configSwitcherInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t configSwitcherInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializing the config switching functionality. </p>
<p>The CONTINOUS task will be loaded to enable slot switches via the task_configswitcher FUNCTIONAL task. </p><dl class="section return"><dt>Returns</dt><dd>ESP_OK if everything is fined, ESP_FAIL otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00294">294</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flipmouse__fabi__esp32__kbdmouse__main_8c_source.html#l00089">app_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8h_aafed047c8d04b814a85239e031cbad7b_cgraph.png" border="0" usemap="#config__switcher_8h_aafed047c8d04b814a85239e031cbad7b_cgraph" alt=""/></div>
<map name="config__switcher_8h_aafed047c8d04b814a85239e031cbad7b_cgraph" id="config__switcher_8h_aafed047c8d04b814a85239e031cbad7b_cgraph">
<area shape="rect" id="node2" href="config__switcher_8c.html#a634f0179096daf06df87ba5cd1789d6b" title="configTimerCallback" alt="" coords="180,296,321,323"/>
<area shape="rect" id="node13" href="config__switcher_8c.html#af5af5079d1982d42e165039e6de7e40a" title="CONTINOUS TASK &#45; Config switcher task, internal config reloading. " alt="" coords="565,208,703,235"/>
<area shape="rect" id="node3" href="hal__adc_8c.html#a4135bb73c2271b4a27db8d8d81884de7" title="Reload ADC config. " alt="" coords="369,443,512,469"/>
<area shape="rect" id="node11" href="hal__ble_8h.html#accf307974a0046bce38582d0260bf841" title="Reset the BLE data. " alt="" coords="391,333,490,360"/>
<area shape="rect" id="node12" href="hal__serial_8c.html#ab2261f95747ee5806ebdec880d09ca89" title="Reset the serial HID report data. " alt="" coords="387,283,494,309"/>
<area shape="rect" id="node4" href="hal__adc_8c.html#aee719704e643d27c1faab768cf4bc22e" title="HAL TASK &#45; Threshold task for ADC. " alt="" coords="560,455,708,481"/>
<area shape="rect" id="node5" href="hal__adc_8c.html#a5e0d74baf098e774b0e3aa0dab621987" title="Read out analog voltages, apply sensor gain and deadzone. " alt="" coords="1033,427,1154,453"/>
<area shape="rect" id="node6" href="hal__adc_8c.html#a8743abcde6f190545c429f072c16106d" title="Report raw values via serial interface. " alt="" coords="1029,477,1157,504"/>
<area shape="rect" id="node8" href="hal__adc_8c.html#a78419739020988cffc83ffcbc7103b05" title="Process pressure sensor (sip &amp; puff) " alt="" coords="768,528,931,555"/>
<area shape="rect" id="node7" href="hal__serial_8c.html#af78683f30da18cfc19c2c91006ec6155" title="Send serial bytes to USB&#45;Serial (USB&#45;CDC) " alt="" coords="1265,432,1428,459"/>
<area shape="rect" id="node9" href="config__switcher_8c.html#a921538bec34d128a44a748fd5a2c391f" title="Get the current config struct. " alt="" coords="1033,579,1154,605"/>
<area shape="rect" id="node10" href="hal__adc_8c.html#a3cddaa804609f2e34f3cbda1d43ff1b4" title="Trigger strong sip/puff + action according to input data. " alt="" coords="1003,528,1183,555"/>
<area shape="rect" id="node14" href="hal__storage_8c.html#aead99606f84645b2bb6ae000461bf819" title="Start a storage transaction. " alt="" coords="759,5,939,32"/>
<area shape="rect" id="node16" href="hal__storage_8c.html#afffed2d32aac2287e95d943dd588db6c" title="Load a slot by an action. " alt="" coords="793,107,905,133"/>
<area shape="rect" id="node22" href="hal__storage_8c.html#a8abf9a5b8727dc8d7cbe76ba0e2dcb6b" title="Delete one or all slots. " alt="" coords="1274,44,1419,71"/>
<area shape="rect" id="node23" href="hal__storage_8c.html#a00b5db14e24d7ada8a42aa6b3f1a1cb7" title="Finish a storage transaction. " alt="" coords="756,208,943,235"/>
<area shape="rect" id="node24" href="hal__storage_8c.html#a57cdf5734cdbad3dbb5f18f71dd27501" title="Load a slot by a slot name. " alt="" coords="776,157,923,184"/>
<area shape="rect" id="node27" href="config__switcher_8c.html#a4c2e410d8032c65c0700c6ca07429074" title="Request config update. " alt="" coords="800,259,899,285"/>
<area shape="rect" id="node28" href="hal__storage_8c.html#aa5da838bef47becbd2b5bd96a60c75b3" title="Get number of currently loaded slot. " alt="" coords="764,310,935,351"/>
<area shape="rect" id="node29" href="hal__adc_8c.html#ae549c157d94729e8b06cb391f0f2c97b" title="Calibration function. " alt="" coords="792,376,907,403"/>
<area shape="rect" id="node15" href="hal__storage_8c.html#a606e5842dd354f1fb4a738ba95c6d5d1" title="internal function to init the filesystem if handle is invalid " alt="" coords="1042,5,1145,32"/>
<area shape="rect" id="node17" href="hal__storage_8c.html#a7e0a934f829b47e2445189dd95e962d6" title="Get the number of stored slots. " alt="" coords="1249,95,1444,121"/>
<area shape="rect" id="node19" href="hal__storage_8c.html#a670ba7fad19e9a70672d73897785712f" title="Load a slot by a slot number (starting with 0) " alt="" coords="1014,183,1173,209"/>
<area shape="rect" id="node18" href="hal__storage_8c.html#a4b6566ef5b69c85d422df52435c95d36" title="Internal helper to check for a valid WL handle and the correct tid. " alt="" coords="1497,171,1627,197"/>
<area shape="rect" id="node20" href="hal__storage_8c.html#aed4beb2e1bd8cd78a201fbcb49958cba" title="Create a new default slot. " alt="" coords="1264,196,1429,223"/>
<area shape="rect" id="node21" href="hal__storage_8c.html#a76299b86e144434260dcab80323ec9da" title="strip" alt="" coords="1539,272,1585,299"/>
<area shape="rect" id="node25" href="hal__storage_8c.html#aae19bcf97360ccd7af4ddf906ff85141" title="Get the number of a slotname. " alt="" coords="991,297,1196,324"/>
<area shape="rect" id="node26" href="hal__storage_8c.html#a2046481d14910cc6a5b0086a796f293b" title="Get the name of a slot number. " alt="" coords="1244,348,1449,375"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8h_aafed047c8d04b814a85239e031cbad7b_icgraph.png" border="0" usemap="#config__switcher_8h_aafed047c8d04b814a85239e031cbad7b_icgraph" alt=""/></div>
<map name="config__switcher_8h_aafed047c8d04b814a85239e031cbad7b_icgraph" id="config__switcher_8h_aafed047c8d04b814a85239e031cbad7b_icgraph">
<area shape="rect" id="node2" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="180,5,259,32"/>
</map>
</div>

</div>
</div>
<a id="a4c2e410d8032c65c0700c6ca07429074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c2e410d8032c65c0700c6ca07429074">&#9670;&nbsp;</a></span>configUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t configUpdate </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request config update. </p>
<p>This method is requesting a config update for the general config. It is used either by the command parser to activate a changed config (by AT commands) or by the config switcher task, to activate a config loaded from flash.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="common_8h.html#a4701c432a28c389e4b8557f2fa3323d1" title="Queue to receive config changing commands. ">config_switcher</a> </dd>
<dd>
currentConfig </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, ESP_FAIL otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00172">172</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="config__switcher_8c_source.html#l00194">configSwitcherTask()</a>, <a class="el" href="task__commands_8c_source.html#l00402">doStorageParsing()</a>, and <a class="el" href="task__commands_8c_source.html#l01648">task_commands()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8h_a4c2e410d8032c65c0700c6ca07429074_icgraph.png" border="0" usemap="#config__switcher_8h_a4c2e410d8032c65c0700c6ca07429074_icgraph" alt=""/></div>
<map name="config__switcher_8h_a4c2e410d8032c65c0700c6ca07429074_icgraph" id="config__switcher_8h_a4c2e410d8032c65c0700c6ca07429074_icgraph">
<area shape="rect" id="node2" href="config__switcher_8c.html#af5af5079d1982d42e165039e6de7e40a" title="CONTINOUS TASK &#45; Config switcher task, internal config reloading. " alt="" coords="152,5,289,32"/>
<area shape="rect" id="node5" href="task__commands_8c.html#a770d94bfbf3d8c959ac003816d2b41fe" title="doStorageParsing" alt="" coords="158,56,283,83"/>
<area shape="rect" id="node6" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="341,81,460,108"/>
<area shape="rect" id="node3" href="config__switcher_8h.html#aafed047c8d04b814a85239e031cbad7b" title="Initializing the config switching functionality. " alt="" coords="337,5,464,32"/>
<area shape="rect" id="node4" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="717,31,796,57"/>
<area shape="rect" id="node7" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="Init the command parser. " alt="" coords="525,56,657,83"/>
<area shape="rect" id="node8" href="task__commands_8h.html#a26091155b4d85093239033d689f363d0" title="Restart the command parser task. " alt="" coords="512,107,669,133"/>
</map>
</div>

</div>
</div>
<a id="a27ed39a214ff60cc13af7058e8f4722e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27ed39a214ff60cc13af7058e8f4722e">&#9670;&nbsp;</a></span>configUpdateWaitStable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t configUpdateWaitStable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait until current configuration is stable. </p>
<p>If the function configUpdateVB is called, a temporary task parameter buffer is used. The full configuration is loaded if configUpdatePending semaphore is free. If the configuration is to be saved, this semaphore should be checked via this method.</p>
<dl class="section note"><dt>Note</dt><dd>This method blocks on the semaphore. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if config is stable, ESP_FAIL if timeout happened </dd></dl>

<p class="definition">Definition at line <a class="el" href="config__switcher_8c_source.html#l00122">122</a> of file <a class="el" href="config__switcher_8c_source.html">config_switcher.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__commands_8c_source.html#l00402">doStorageParsing()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="config__switcher_8h_a27ed39a214ff60cc13af7058e8f4722e_icgraph.png" border="0" usemap="#config__switcher_8h_a27ed39a214ff60cc13af7058e8f4722e_icgraph" alt=""/></div>
<map name="config__switcher_8h_a27ed39a214ff60cc13af7058e8f4722e_icgraph" id="config__switcher_8h_a27ed39a214ff60cc13af7058e8f4722e_icgraph">
<area shape="rect" id="node2" href="task__commands_8c.html#a770d94bfbf3d8c959ac003816d2b41fe" title="doStorageParsing" alt="" coords="216,31,341,57"/>
<area shape="rect" id="node3" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="389,31,508,57"/>
<area shape="rect" id="node4" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="Init the command parser. " alt="" coords="569,5,701,32"/>
<area shape="rect" id="node6" href="task__commands_8h.html#a26091155b4d85093239033d689f363d0" title="Restart the command parser task. " alt="" coords="556,56,713,83"/>
<area shape="rect" id="node5" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="761,5,840,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
