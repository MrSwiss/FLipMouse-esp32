<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLipMouse/FABI ESP32 firmware: /home/beni/sync/Projects/FH/FLipMouse-esp32/main/function_tasks/task_commands.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLipMouse/FABI ESP32 firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li><li class="navelem"><a class="el" href="dir_dd44d79ba9a472f66a6851d54403189f.html">function_tasks</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">task_commands.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="task__commands_8h_source.html">task_commands.h</a>&quot;</code><br />
</div>
<p><a href="task__commands_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7ce0df38eb467e59f209470c8f5ac4e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__commands_8c.html#a7ce0df38eb467e59f209470c8f5ac4e6">LOG_TAG</a>&#160;&#160;&#160;&quot;cmdparser&quot;</td></tr>
<tr class="separator:a7ce0df38eb467e59f209470c8f5ac4e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a67e18f3921bbb80116577096dd7fccac"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__commands_8c.html#a67e18f3921bbb80116577096dd7fccac">doMouseParsing</a> (uint8_t *cmdBuffer, <a class="el" href="task__mouse_8h.html#aa8af5afb3b111ccabb1e207ae4cabcaa">taskMouseConfig_t</a> *mouseinstance)</td></tr>
<tr class="separator:a67e18f3921bbb80116577096dd7fccac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31a9d83daca23614cd71d9bb8b3d8312"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__commands_8c.html#a31a9d83daca23614cd71d9bb8b3d8312">doKeyboardParsing</a> (uint8_t *cmdBuffer, <a class="el" href="task__kbd_8h.html#a1ea00a7b13dc2b804f53e6f79cb89f2c">taskKeyboardConfig_t</a> *kbdinstance)</td></tr>
<tr class="separator:a31a9d83daca23614cd71d9bb8b3d8312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b36c39275d773aaedcb327ef4e1516f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f">task_commands</a> (void *params)</td></tr>
<tr class="separator:a7b36c39275d773aaedcb327ef4e1516f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedb896e40753227f80768e09d3748419"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__commands_8c.html#aedb896e40753227f80768e09d3748419">taskCommandsInit</a> (void)</td></tr>
<tr class="separator:aedb896e40753227f80768e09d3748419"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26091155b4d85093239033d689f363d0"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__commands_8c.html#a26091155b4d85093239033d689f363d0">taskCommandsRestart</a> (void)</td></tr>
<tr class="separator:a26091155b4d85093239033d689f363d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7ce0df38eb467e59f209470c8f5ac4e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce0df38eb467e59f209470c8f5ac4e6">&#9670;&nbsp;</a></span>LOG_TAG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOG_TAG&#160;&#160;&#160;&quot;cmdparser&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>UNIMPLEMENTED AT commands </p><pre class="fragment">  AT                returns "OK"
  AT ID             returns identification string (e.g. "FLipMouse V2.0")
  AT BM &lt;uint&gt;      puts button into programming mode (e.g. "AT BM 2" -&gt; next AT-command defines the new function for button 2)
                    virtual buttons are defined in common.h
</pre><p>USB HID commands: </p><pre class="fragment">  AT RO &lt;uint&gt;      rotate stick orientation (e.g. "AT RO 180" flips x any y movements)  

  AT JX &lt;int&gt;       set joystick x axis (e.g. "AT JX 512" sets the x-axis to middle position)  
  AT JY &lt;int&gt;       set joystick y axis (e.g. "AT JY 1023" sets the y-axis to full up position)  
  AT JZ &lt;int&gt;       set joystick z axis (e.g. "AT JZ 0" sets the z-axis to lowest position)  
  AT JT &lt;int&gt;       set joystick z turn axis (e.g. "AT JR 512" sets the rotation to middle position)  
  AT JS &lt;int&gt;       set joystick slider position (e.g. "AT JS 512" sets the slider to middle position)  
  AT JP &lt;int&gt;       press joystick button (e.g. "AT JP 1" presses joystick button 1)  
  AT JR &lt;int&gt;       release joystick button (e.g. "AT JP 2" releases joystick button 2)  
  AT JH &lt;int&gt;       set joystick hat position (e.g. "AT JH 45" sets joystick hat to 45 degrees)
                    possible values are: 0, 45, 90, 135, 180, 225, 270, 315 and -1 to set center position)   

  AT KW &lt;string&gt;    keyboard write string (e.g." AT KW Hello!" writes "Hello!")    
  AT KP &lt;string&gt;    key press: press/hold keys identifier 
                    (e.g. "AT KP KEY_UP" presses the "Cursor-Up" key, "AT KP KEY_CTRL KEY_ALT KEY_DELETE" presses all three keys)
  AT KH &lt;string&gt;    key hold: sticky hold keys (key will be pressed until next button press or "AT KH" command) 
                    (e.g. "AT KH KEY_A" presses the "A" key until  "AT KH KEY_A" is called again)
                    for a list of supported key identifier strings see below ! 

  AT KR &lt;string&gt;    key release: releases all keys identified in the string    
  AT RA             release all: releases all currently pressed keys and buttons    
</pre><p>Housekeeping commands: </p><pre class="fragment">  AT SA &lt;string&gt;  save settings and current button modes to next free eeprom slot under given name (e.g. AT SAVE mouse1)
  AT LO &lt;string&gt;  load button modes from eeprom slot (e.g. AT LOAD mouse1 -&gt; loads profile named "mouse1")
  AT LA           load all slots (displays names and settings of all stored slots) 
  AT LI           list all saved mode names 
  AT NE           next mode will be loaded (wrap around after last slot)
  AT DE           delete EEPROM content (delete all stored slots)
  AT NC           no command (idle operation)
  AT E0           turn echo off (no debug output on serial console, default and GUI compatible)
  AT E1           turn echo on (debug output on serial console)
  AT E2           turn echo on (debug output on serial console), extended output
  AT BT &lt;uint&gt;    set bluetooth mode, 1=USB only, 2=BT only, 3=both(default) 
                  (e.g. AT BT 2 -&gt; send HID commands only via BT if BT-daughter board is available)
</pre><p>FLipMouse-specific settings and commands: </p><pre class="fragment">  AT MM &lt;uint&gt;    mouse mode: cursor on (uint==1) or alternative functions on (uint==0)
  AT SW           switch between mouse cursor and alternative functions
  AT SR           start reporting raw values (5 sensor values, starting with "VALUES:") 
  AT ER           end reporting raw values
  AT CA           calibration of zeropoint
  AT AX &lt;uint&gt;    acceleration x-axis  (0-100)
  AT AY &lt;uint&gt;    acceleration y-axis  (0-100)
  AT DX &lt;uint&gt;    deadzone x-axis  (0-1000)
  AT DY &lt;uint&gt;    deadzone y-axis  (0-1000)
  AT MS &lt;uint&gt;    maximum speed  (0-100)
  AT AC &lt;uint&gt;    acceleration time (0-100)
  AT MA &lt;string&gt;  execute a command macro containing multiple commands (separated by semicolon) 
                  example: "AT MA MX 100;MY 100;CL;"  use backslash to mask semicolon: "AT MA KW \;;CL;" writes a semicolon and then clicks left 
  AT WA &lt;uint&gt;    wait (given in milliseconds, useful for macro commands)

  AT TS &lt;uint&gt;    treshold for sip action  (0-512)
  AT TP &lt;uint&gt;    treshold for puff action (512-1023)
  AT SP &lt;uint&gt;    treshold for strong puff (512-1023)
  AT SS &lt;uint&gt;    treshold for strong sip (0-512)
  AT GU &lt;uint&gt;    gain for up sensor (0-100)
  AT GD &lt;uint&gt;    gain for down sensor (0-100)
  AT GL &lt;uint&gt;    gain for left sensor (0-100)
  AT GR &lt;uint&gt;    gain for right sensor (0-100)
</pre><p>Infrared-specific commands: </p><pre class="fragment">  AT IR &lt;string&gt;  record new infrared code and store it under given name (e.g. "AT IR vol_up")
  AT IP &lt;string&gt;  play  infrared code with given name (e.g. "AT IP vol_up")
  AT IC &lt;string&gt;  clear infrared code with given name (e.g. "AT IC vol_up")
  AT IW           wipe infrared memory (clear all codes)
  AT IL           lists all stored infrared command names
  AT IT &lt;uint&gt;    set code timeout value for IR Recording (e.g. "AT IT 10" sets 10 milliseconds timeout)</pre> 
<p class="definition">Definition at line <a class="el" href="task__commands_8c_source.html#l00110">110</a> of file <a class="el" href="task__commands_8c_source.html">task_commands.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__commands_8c_source.html#l00148">doMouseParsing()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a31a9d83daca23614cd71d9bb8b3d8312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31a9d83daca23614cd71d9bb8b3d8312">&#9670;&nbsp;</a></span>doKeyboardParsing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t doKeyboardParsing </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cmdBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="task__kbd_8h.html#a1ea00a7b13dc2b804f53e6f79cb89f2c">taskKeyboardConfig_t</a> *&#160;</td>
          <td class="paramname"><em>kbdinstance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="task__commands_8c_source.html#l00141">141</a> of file <a class="el" href="task__commands_8c_source.html">task_commands.c</a>.</p>

</div>
</div>
<a id="a67e18f3921bbb80116577096dd7fccac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67e18f3921bbb80116577096dd7fccac">&#9670;&nbsp;</a></span>doMouseParsing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t doMouseParsing </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cmdBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="task__mouse_8h.html#aa8af5afb3b111ccabb1e207ae4cabcaa">taskMouseConfig_t</a> *&#160;</td>
          <td class="paramname"><em>mouseinstance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="task__commands_8c_source.html#l00148">148</a> of file <a class="el" href="task__commands_8c_source.html">task_commands.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="task__commands_8c_a67e18f3921bbb80116577096dd7fccac_cgraph.png" border="0" usemap="#task__commands_8c_a67e18f3921bbb80116577096dd7fccac_cgraph" alt=""/></div>
<map name="task__commands_8c_a67e18f3921bbb80116577096dd7fccac_cgraph" id="task__commands_8c_a67e18f3921bbb80116577096dd7fccac_cgraph">
<area shape="rect" id="node2" href="task__mouse_8c.html#aa8f5c0436e569589e735c419fc3d0ed8" title="task_mouse" alt="" coords="189,5,282,32"/>
<area shape="rect" id="node3" href="task__mouse_8c.html#ab5cfaaac2cd4ec6fc79546f847db96de" title="mouse_get_wheel" alt="" coords="172,56,299,83"/>
<area shape="rect" id="node4" href="task__mouse_8c.html#ac5aaa616044b7bef9f75347719181dbe" title="mouse_set_wheel" alt="" coords="172,107,299,133"/>
</map>
</div>

</div>
</div>
<a id="a7b36c39275d773aaedcb327ef4e1516f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b36c39275d773aaedcb327ef4e1516f">&#9670;&nbsp;</a></span>task_commands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task_commands </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="task__commands_8c_source.html#l00253">253</a> of file <a class="el" href="task__commands_8c_source.html">task_commands.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__commands_8c_source.html#l00303">taskCommandsInit()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="task__commands_8c_a7b36c39275d773aaedcb327ef4e1516f_icgraph.png" border="0" usemap="#task__commands_8c_a7b36c39275d773aaedcb327ef4e1516f_icgraph" alt=""/></div>
<map name="task__commands_8c_a7b36c39275d773aaedcb327ef4e1516f_icgraph" id="task__commands_8c_a7b36c39275d773aaedcb327ef4e1516f_icgraph">
<area shape="rect" id="node2" href="task__commands_8h.html#aedb896e40753227f80768e09d3748419" title="taskCommandsInit" alt="" coords="172,5,304,32"/>
<area shape="rect" id="node3" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="app_main" alt="" coords="352,5,431,32"/>
</map>
</div>

</div>
</div>
<a id="aedb896e40753227f80768e09d3748419"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedb896e40753227f80768e09d3748419">&#9670;&nbsp;</a></span>taskCommandsInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t taskCommandsInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Init the command parser</p>
<p>This method starts the command parser task, which handles incoming UART bytes &amp; responses if necessary. If necessary, this task deletes itself &amp; starts a CIM task (it MUST be the other way as well to restart the AT command parser) </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="task__commands_8c.html#a26091155b4d85093239033d689f363d0">taskCommandsRestart</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, ESP_FAIL otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="task__commands_8c_source.html#l00303">303</a> of file <a class="el" href="task__commands_8c_source.html">task_commands.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flipmouse__fabi__esp32__kbdmouse__main_8c_source.html#l00410">app_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="task__commands_8c_aedb896e40753227f80768e09d3748419_cgraph.png" border="0" usemap="#task__commands_8c_aedb896e40753227f80768e09d3748419_cgraph" alt=""/></div>
<map name="task__commands_8c_aedb896e40753227f80768e09d3748419_cgraph" id="task__commands_8c_aedb896e40753227f80768e09d3748419_cgraph">
<area shape="rect" id="node2" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f" title="task_commands" alt="" coords="185,5,304,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="task__commands_8c_aedb896e40753227f80768e09d3748419_icgraph.png" border="0" usemap="#task__commands_8c_aedb896e40753227f80768e09d3748419_icgraph" alt=""/></div>
<map name="task__commands_8c_aedb896e40753227f80768e09d3748419_icgraph" id="task__commands_8c_aedb896e40753227f80768e09d3748419_icgraph">
<area shape="rect" id="node2" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="app_main" alt="" coords="185,5,264,32"/>
</map>
</div>

</div>
</div>
<a id="a26091155b4d85093239033d689f363d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26091155b4d85093239033d689f363d0">&#9670;&nbsp;</a></span>taskCommandsRestart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t taskCommandsRestart </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Restart the command parser task</p>
<p>This method is used, if the CIM parser detects AT commands and stops itself, providing the AT command set again. </p><dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, ESP_FAIL otherwise (cannot start task, task already running) </dd></dl>

<p class="definition">Definition at line <a class="el" href="task__commands_8c_source.html#l00320">320</a> of file <a class="el" href="task__commands_8c_source.html">task_commands.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
