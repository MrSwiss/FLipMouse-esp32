<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLipMouse/FABI ESP32 firmware: /home/beni/sync/Projects/FH/FLipMouse-esp32/main/function_tasks/task_webgui.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLipMouse/FABI ESP32 firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li><li class="navelem"><a class="el" href="dir_dd44d79ba9a472f66a6851d54403189f.html">function_tasks</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">task_webgui.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>CONTINOUS TASK - Web server &amp; WebGUI handling.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;freertos/FreeRTOS.h&gt;</code><br />
<code>#include &lt;freertos/event_groups.h&gt;</code><br />
<code>#include &lt;freertos/queue.h&gt;</code><br />
<code>#include &lt;freertos/task.h&gt;</code><br />
<code>#include &lt;esp_log.h&gt;</code><br />
<code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &quot;esp_wifi.h&quot;</code><br />
<code>#include &quot;esp_event_loop.h&quot;</code><br />
<code>#include &quot;nvs.h&quot;</code><br />
<code>#include &quot;nvs_flash.h&quot;</code><br />
<code>#include &quot;esp_partition.h&quot;</code><br />
<code>#include &quot;esp_err.h&quot;</code><br />
<code>#include &quot;esp_vfs.h&quot;</code><br />
<code>#include &quot;esp_vfs_fat.h&quot;</code><br />
<code>#include &quot;lwip/api.h&quot;</code><br />
<code>#include &quot;lwip/err.h&quot;</code><br />
<code>#include &quot;lwip/netdb.h&quot;</code><br />
<code>#include &quot;<a class="el" href="captdns_8h_source.html">captdns.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="websocket_8h_source.html">websocket.h</a>&quot;</code><br />
</div>
<p><a href="task__webgui_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ade7be3b4d9fe3cc3d775bd69aaf1708e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__webgui_8h.html#ade7be3b4d9fe3cc3d775bd69aaf1708e">TASK_WEBGUI_WEBSOCKET_STACKSIZE</a>&#160;&#160;&#160;8192</td></tr>
<tr class="memdesc:ade7be3b4d9fe3cc3d775bd69aaf1708e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stack size for websocket server task.  <a href="#ade7be3b4d9fe3cc3d775bd69aaf1708e">More...</a><br /></td></tr>
<tr class="separator:ade7be3b4d9fe3cc3d775bd69aaf1708e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d5d3c993fa016a56ba00fad8999acc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__webgui_8h.html#a86d5d3c993fa016a56ba00fad8999acc">TASK_WEBGUI_SERVER_STACKSIZE</a>&#160;&#160;&#160;8192</td></tr>
<tr class="memdesc:a86d5d3c993fa016a56ba00fad8999acc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stack size for web server task.  <a href="#a86d5d3c993fa016a56ba00fad8999acc">More...</a><br /></td></tr>
<tr class="separator:a86d5d3c993fa016a56ba00fad8999acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef5090f2bc5184eff59e3dba3992ed7b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__webgui_8h.html#aef5090f2bc5184eff59e3dba3992ed7b">TASK_WEBGUI_WSPORT</a>&#160;&#160;&#160;1804</td></tr>
<tr class="memdesc:aef5090f2bc5184eff59e3dba3992ed7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Websocket port.  <a href="#aef5090f2bc5184eff59e3dba3992ed7b">More...</a><br /></td></tr>
<tr class="separator:aef5090f2bc5184eff59e3dba3992ed7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a669b9245d5040c0162481f7b24dbeea7"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__webgui_8h.html#a669b9245d5040c0162481f7b24dbeea7">taskWebGUIInit</a> (void)</td></tr>
<tr class="memdesc:a669b9245d5040c0162481f7b24dbeea7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init the web / DNS server and the web gui.  <a href="#a669b9245d5040c0162481f7b24dbeea7">More...</a><br /></td></tr>
<tr class="separator:a669b9245d5040c0162481f7b24dbeea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>CONTINOUS TASK - Web server &amp; WebGUI handling. </p>
<p>This module is used to serve the web- &amp; DNS server for captive portal mode and the web configuration GUI.</p>
<p>In addition, AT commands are sent to the command parser, the same way as if they would be sent by any host configuration software. In this mode feedback (which is usually sent to the serial interface) is sent back to the webgui for parsing in JS.</p>
<dl class="section see"><dt>See also</dt><dd>hal_serial </dd>
<dd>
<a class="el" href="task__commands_8c.html#a7b36c39275d773aaedcb327ef4e1516f">task_commands</a> </dd>
<dd>
atcmd_api</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000023">Todo:</a></b></dt><dd><p class="startdd">Implement everything (or better said: port it from existing demo) </p>
<p class="enddd">How to integrate into hal_serial? Sending commands to task_commands is easy, but the other way round... </p>
</dd></dl>

<p class="definition">Definition in file <a class="el" href="task__webgui_8h_source.html">task_webgui.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a86d5d3c993fa016a56ba00fad8999acc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86d5d3c993fa016a56ba00fad8999acc">&#9670;&nbsp;</a></span>TASK_WEBGUI_SERVER_STACKSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TASK_WEBGUI_SERVER_STACKSIZE&#160;&#160;&#160;8192</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stack size for web server task. </p>

<p class="definition">Definition at line <a class="el" href="task__webgui_8h_source.html#l00073">73</a> of file <a class="el" href="task__webgui_8h_source.html">task_webgui.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__webgui_8c_source.html#l00322">taskWebGUIInit()</a>.</p>

</div>
</div>
<a id="ade7be3b4d9fe3cc3d775bd69aaf1708e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade7be3b4d9fe3cc3d775bd69aaf1708e">&#9670;&nbsp;</a></span>TASK_WEBGUI_WEBSOCKET_STACKSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TASK_WEBGUI_WEBSOCKET_STACKSIZE&#160;&#160;&#160;8192</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stack size for websocket server task. </p>

<p class="definition">Definition at line <a class="el" href="task__webgui_8h_source.html#l00070">70</a> of file <a class="el" href="task__webgui_8h_source.html">task_webgui.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__webgui_8c_source.html#l00322">taskWebGUIInit()</a>.</p>

</div>
</div>
<a id="aef5090f2bc5184eff59e3dba3992ed7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef5090f2bc5184eff59e3dba3992ed7b">&#9670;&nbsp;</a></span>TASK_WEBGUI_WSPORT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TASK_WEBGUI_WSPORT&#160;&#160;&#160;1804</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Websocket port. </p>

<p class="definition">Definition at line <a class="el" href="task__webgui_8h_source.html#l00076">76</a> of file <a class="el" href="task__webgui_8h_source.html">task_webgui.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="task__webgui_8c_source.html#l00101">ws_server()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a669b9245d5040c0162481f7b24dbeea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a669b9245d5040c0162481f7b24dbeea7">&#9670;&nbsp;</a></span>taskWebGUIInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t taskWebGUIInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init the web / DNS server and the web gui. </p>
<p>TBD: documentation what is done here</p>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, ESP_FAIL otherwise</dd></dl>
<p>TBD: documentation what is done here</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000022">Todo:</a></b></dt><dd>For testing, webserver will be active on startup. In final version, webserver is active on long button press only for 10min (SECURITY!) </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, ESP_FAIL otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="task__webgui_8c_source.html#l00322">322</a> of file <a class="el" href="task__webgui_8c_source.html">task_webgui.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flipmouse__fabi__esp32__kbdmouse__main_8c_source.html#l00074">app_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="task__webgui_8h_a669b9245d5040c0162481f7b24dbeea7_cgraph.png" border="0" usemap="#task__webgui_8h_a669b9245d5040c0162481f7b24dbeea7_cgraph" alt=""/></div>
<map name="task__webgui_8h_a669b9245d5040c0162481f7b24dbeea7_cgraph" id="task__webgui_8h_a669b9245d5040c0162481f7b24dbeea7_cgraph">
<area shape="rect" id="node2" href="task__webgui_8c.html#a11dd6a5edc46c297b26382ebce3c34cb" title="Event handler for wifi status updates. " alt="" coords="169,107,300,133"/>
<area shape="rect" id="node7" href="task__webgui_8c.html#adcc5b062c057f73762b1f19b2f6a8185" title="CONTINOUS TASK &#45; Main webserver task. " alt="" coords="191,216,278,243"/>
<area shape="rect" id="node10" href="task__webgui_8c.html#a5f462e5b8bd4803c256bf22a004eacde" title="CONTINOUS TASK &#45; Websocket server task. " alt="" coords="193,271,276,297"/>
<area shape="rect" id="node3" href="task__webgui_8c.html#adf50753dada544362b8f4fb5f8eefde5" title="Get the number of currently connected Wifi stations. " alt="" coords="364,5,535,32"/>
<area shape="rect" id="node4" href="hal__serial_8c.html#a143968f329a010a1075a81b976579605" title="Set an additional function for outputting the serial data. " alt="" coords="361,56,537,83"/>
<area shape="rect" id="node5" href="websocket_8c.html#a215997a5d454937f96cf800e1a44e599" title="WS_write_data" alt="" coords="394,107,505,133"/>
<area shape="rect" id="node6" href="hal__serial_8c.html#a57242c09ec880fbd08e1a4cd5e64d8e5" title="Remove the additional function for outputting the serial data. " alt="" coords="348,157,551,184"/>
<area shape="rect" id="node8" href="task__webgui_8c.html#ab8747e57d0c6f817143de09e0ac8696d" title="Handle an incoming HTTP connection. " alt="" coords="379,209,519,250"/>
<area shape="rect" id="node9" href="task__webgui_8c.html#a6602b92d93539366ba1c5535690ebe7e" title="Serve static content from FAT. " alt="" coords="599,216,675,243"/>
<area shape="rect" id="node11" href="websocket_8c.html#afc7ea5da54622021156f0df84063abb4" title="ws_server_netconn_serve" alt="" coords="362,275,537,301"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="task__webgui_8h_a669b9245d5040c0162481f7b24dbeea7_icgraph.png" border="0" usemap="#task__webgui_8h_a669b9245d5040c0162481f7b24dbeea7_icgraph" alt=""/></div>
<map name="task__webgui_8h_a669b9245d5040c0162481f7b24dbeea7_icgraph" id="task__webgui_8h_a669b9245d5040c0162481f7b24dbeea7_icgraph">
<area shape="rect" id="node2" href="flipmouse__fabi__esp32__kbdmouse__main_8c.html#abce06be17fc37d675118a678a8100a36" title="Main task, created by esp&#45;idf. " alt="" coords="169,5,248,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
