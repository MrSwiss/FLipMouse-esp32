<html>
<head>
    <title>FlipMouse WebGUI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/tabby.min.css">
    <link rel="stylesheet" href="css/custom.css">
    <script src="lib/lquery.js"></script>
    <script src="lib/areCommunicatorLight.js"></script>
    <script src="lib/flipMouseCommunicator.js"></script>
    <script src="lib/tabby.min.js"></script>
    <script src="lib/dom-i18n.min.js"></script>
</head>
<body>
<div id="content">
    <h1 data-translatable>FLipMouse Web Configuration // FLipMouse Webkonfiguration</h1>

    <div data-tabs class="row">
        <div class="four columns"><a class="button button-primary" data-tab href="#tabBasic" class="ui-btn-active" data-translatable>Basic Setup // Basiskonfiguration</a></div>
        <div class="four columns"><a class="button button-primary" data-tab href="#tabPuff">Sip and Puff</a></div>
        <div class="four columns"><a class="button button-primary" data-tab href="#tabActions">Learn Actions</a></div>
    </div>
    <div data-tabs-content>
        <div data-tabs-pane class="tabs-pane" id="tabBasic">
            <label for="SENSITIVITY_X">Horizontal Sensitivity:</label>
            <div class="row">
                <span id="SENSITIVITY_X_VAL" class="text-center one column">0</span>
                <input type="range" oninput="sliderChanged(event)" onchange="sliderChanged(event)" id="SENSITIVITY_X" min="0" max="100" class="eleven columns">
            </div>
            <label for="SENSITIVITY_Y">Vertical Sensitivity:</label>
            <div class="row">
                <span id="SENSITIVITY_Y_VAL" class="text-center one column">0</span>
                <input type="range" oninput="sliderChanged(event)" onchange="sliderChanged(event)" id="SENSITIVITY_Y" min="0" max="100" class="eleven columns">
            </div>

            <br/>
            <label for="DEADZONE_X">Horizontal Deadzone:</label>
            <div class="row">
                <span id="DEADZONE_X_VAL" class="text-center one column">0</span>
                <input type="range" oninput="sliderChanged(event)" onchange="sliderChanged(event)" id="DEADZONE_X" min="0" max="100" class="eleven columns">
            </div>
            <label for="DEADZONE_Y">Vertical Deadzone:</label>
            <div class="row">
                <span id="DEADZONE_Y_VAL" class="text-center one column">0</span>
                <input type="range" oninput="sliderChanged(event)" onchange="sliderChanged(event)" id="DEADZONE_Y" min="0" max="100" class="eleven columns">
            </div>

            <br/>
            <br/>
            <div class="row">
                <button id="basic-button" onclick="save()" class="one-third">
                    <span id="basic-button-normal" data-translatable>Apply // Speichern</span>
                    <span id="basic-button-saving" style="display: none" data-translatable>Saving... // Wird gespeichert...</span>
                </button>
            </div>
        </div>
        <div data-tabs-pane class="tabs-pane" id="tabPuff">
            <div class="empty-separator"></div>
            <label for="pressure-1">Pressure level for puff:</label>
            <input type="range" data-clear-btn="true" name="set-pressure-level" id="set-pressure-level" min="0"
                   max="1200">
            <label for="pressure-2">Actual pressure level:</label>
            <input type="number" name="actual-pressure-level" id="actual-pressure-level" value=""
                   data-disabled="true">
            <div class="empty-separator"></div>
            <input type="button" id="pressure-button" value="Apply">

        </div>
        <div data-tabs-pane class="tabs-pane" id="tabActions">
            <div class="empty-separator"></div>

            <label for="action-1">Select an action:</label>
            <select id="actioncommand">
                <option selected="selected" value="CL">Click Left</option>
                <option value="CR">Click Right</option>
                <option value="PL">Press (Hold) Left</option>
                <option value="KW">Write Keyboard</option>
            </select>
            <label for="action-2">additional paramters (text or value):</label>
            <input type="text" data-clear-btn="true" name="actionparameter" id="actionparameter" value="">
            <div class="empty-separator"></div>
            <input type="button" id="action-button" value="Learn Gesture">
        </div>
    </div>
</div>

<script>
    window.onload = function () {
        var flip = new FlipMouse(function (config) {
            setSliderValue(flip.SENSITIVITY_X, config[flip.SENSITIVITY_X]);
            setSliderValue(flip.SENSITIVITY_Y, config[flip.SENSITIVITY_Y]);
            setSliderValue(flip.DEADZONE_X, config[flip.DEADZONE_X]);
            setSliderValue(flip.DEADZONE_Y, config[flip.DEADZONE_Y]);
            console.log(config);
        });
        window.flip = flip;
    };

    function sliderChanged(evt) {
        setSliderValue(evt.currentTarget.id, evt.currentTarget.value, true);
        window.flip.setValue(evt.currentTarget.id, evt.currentTarget.value);
    }

    function setSliderValue(constant, value, dontSetSlider) {
        L('#' + constant + '_VAL').innerHTML = value;
        if(!dontSetSlider) {
            L('#' + constant).value = value;
        }
    }

    function save() {
        L.toggle('#basic-button-normal', '#basic-button-saving');
        window.flip.save().then(function (success) {
            if(success) {
                L.toggle('#basic-button-normal', '#basic-button-saving');
                console.log('!!!!!!!!!!!!');
            }
        });
    }
</script>
<script>
    tabby.init();
    domI18n({
        selector: '[data-translatable]',
        separator: ' // ',
        languages: ['en', 'de']
    });
</script>
</body>
</html>